* `Browse and query this table online <https://data.catalyst.coop/search?&q=name:{{ resource.name }}>`__
* `Download this table as a Parquet file <https://s3.us-west-2.amazonaws.com/pudl.catalyst.coop/nightly/{{ resource.name }}.parquet>`__

.. warning::

   This table will likely not fit in your computer's memory.
   Make sure to filter or aggregate to reduce the amount of data read in.
   This is easier in ``polars`` and ``duckdb`` than in ``pandas``,
   so we only provide examples for these.

.. tabs::

   .. tab:: polars

      .. code-block:: python

         import polars as pl
         df = (
             # Use scan_parquet (lazy evaluation) to plan the query before execution
             pl.scan_parquet(
                 "s3://pudl.catalyst.coop/nightly/{{ resource.name }}.parquet",
                 storage_options={"aws_region": "us-west-2"},
             )
             # Select only a subset of columns to reduce network and memory usage
             .select(
                 [
                     "report_year",
                     "datetime_utc",
                     "hour_of_year",
                     "county_id_fips",
                     "state",
                     "place_name",
                     "capacity_factor_solar_pv",
                 ]
             )
             .filter(
                 # Select data for only a single year and state to reduce network and memory usage
                 (pl.col("report_year") == 2022)
                 & (pl.col("state") == "CO")
             )
             .collect()
         )

   .. tab:: SQL (DuckDB)

      .. code-block:: sql

         SELECT
             -- Select only a subset of columns to reduce network and memory usage
             report_year,
             datetime_utc,
             hour_of_year,
             county_id_fips,
             state,
             place_name,
             capacity_factor_solar_pv
         FROM 's3://pudl.catalyst.coop/nightly/{{ resource.name }}.parquet';
         WHERE
             -- Select data for only a single year and state to reduce network and memory usage
             report_year = 2022
             AND state = "CO";
