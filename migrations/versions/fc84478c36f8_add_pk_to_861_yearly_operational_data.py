"""Add pk to 861 yearly_operational_data

Revision ID: fc84478c36f8
Revises: 5ba8ad3ad527
Create Date: 2025-12-05 14:46:06.536977

"""
from alembic import op
import sqlalchemy as sa


# revision identifiers, used by Alembic.
revision = 'fc84478c36f8'
down_revision = '5ba8ad3ad527'
branch_labels = None
depends_on = None


def upgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_table('_alembic_tmp_core_eia861__yearly_operational_data_')
    with op.batch_alter_table('core_eia861__yearly_operational_data_misc', schema=None) as batch_op:
        batch_op.alter_column('nerc_region',
               existing_type=sa.VARCHAR(length=9),
               nullable=False)
        batch_op.alter_column('report_date',
               existing_type=sa.DATE(),
               nullable=False)
        batch_op.alter_column('utility_id_eia',
               existing_type=sa.INTEGER(),
               nullable=False)

    with op.batch_alter_table('core_eia861__yearly_operational_data_revenue', schema=None) as batch_op:
        batch_op.alter_column('nerc_region',
               existing_type=sa.VARCHAR(length=9),
               nullable=False)
        batch_op.alter_column('report_date',
               existing_type=sa.DATE(),
               nullable=False)
        batch_op.alter_column('revenue_class',
               existing_type=sa.VARCHAR(length=22),
               nullable=False)
        batch_op.alter_column('utility_id_eia',
               existing_type=sa.INTEGER(),
               nullable=False)

    # ### end Alembic commands ###


def downgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    with op.batch_alter_table('core_eia861__yearly_operational_data_revenue', schema=None) as batch_op:
        batch_op.alter_column('utility_id_eia',
               existing_type=sa.INTEGER(),
               nullable=True)
        batch_op.alter_column('revenue_class',
               existing_type=sa.VARCHAR(length=22),
               nullable=True)
        batch_op.alter_column('report_date',
               existing_type=sa.DATE(),
               nullable=True)
        batch_op.alter_column('nerc_region',
               existing_type=sa.VARCHAR(length=9),
               nullable=True)

    with op.batch_alter_table('core_eia861__yearly_operational_data_misc', schema=None) as batch_op:
        batch_op.alter_column('utility_id_eia',
               existing_type=sa.INTEGER(),
               nullable=True)
        batch_op.alter_column('report_date',
               existing_type=sa.DATE(),
               nullable=True)
        batch_op.alter_column('nerc_region',
               existing_type=sa.VARCHAR(length=9),
               nullable=True)

    op.create_table('_alembic_tmp_core_eia861__yearly_operational_data_',
    sa.Column('consumed_by_facility_mwh', sa.FLOAT(), nullable=True),
    sa.Column('consumed_by_respondent_without_charge_mwh', sa.FLOAT(), nullable=True),
    sa.Column('data_observed', sa.BOOLEAN(), nullable=True),
    sa.Column('entity_type', sa.TEXT(), nullable=True),
    sa.Column('exchange_energy_delivered_mwh', sa.FLOAT(), nullable=True),
    sa.Column('exchange_energy_received_mwh', sa.FLOAT(), nullable=True),
    sa.Column('furnished_without_charge_mwh', sa.FLOAT(), nullable=True),
    sa.Column('nerc_region', sa.VARCHAR(length=9), nullable=False),
    sa.Column('net_generation_mwh', sa.FLOAT(), nullable=True),
    sa.Column('net_power_exchanged_mwh', sa.FLOAT(), nullable=True),
    sa.Column('net_wheeled_power_mwh', sa.FLOAT(), nullable=True),
    sa.Column('report_date', sa.DATE(), nullable=False),
    sa.Column('retail_sales_mwh', sa.FLOAT(), nullable=True),
    sa.Column('sales_for_resale_mwh', sa.FLOAT(), nullable=True),
    sa.Column('short_form', sa.BOOLEAN(), nullable=True),
    sa.Column('state', sa.TEXT(), nullable=False),
    sa.Column('summer_peak_demand_mw', sa.FLOAT(), nullable=True),
    sa.Column('total_disposition_mwh', sa.FLOAT(), nullable=True),
    sa.Column('total_energy_losses_mwh', sa.FLOAT(), nullable=True),
    sa.Column('total_sources_mwh', sa.FLOAT(), nullable=True),
    sa.Column('transmission_by_other_losses_mwh', sa.FLOAT(), nullable=True),
    sa.Column('utility_id_eia', sa.INTEGER(), nullable=False),
    sa.Column('utility_name_eia', sa.TEXT(), nullable=True),
    sa.Column('wheeled_power_delivered_mwh', sa.FLOAT(), nullable=True),
    sa.Column('wheeled_power_received_mwh', sa.FLOAT(), nullable=True),
    sa.Column('wholesale_power_purchases_mwh', sa.FLOAT(), nullable=True),
    sa.Column('winter_peak_demand_mw', sa.FLOAT(), nullable=True),
    sa.Column('data_maturity', sa.TEXT(), nullable=True),
    sa.ForeignKeyConstraint(['data_maturity'], ['core_pudl__codes_data_maturities.code'], name=op.f('fk_core_eia861__yearly_operational_data_misc_data_maturity_core_pudl__codes_data_maturities'))
    )
    # ### end Alembic commands ###
