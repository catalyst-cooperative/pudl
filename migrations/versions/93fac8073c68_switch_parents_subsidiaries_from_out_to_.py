"""Switch parents & subsidiaries from out to core

Revision ID: 93fac8073c68
Revises: b4a1f715fe75
Create Date: 2025-03-28 13:21:08.271606

"""
from alembic import op
import sqlalchemy as sa


# revision identifiers, used by Alembic.
revision = '93fac8073c68'
down_revision = 'b4a1f715fe75'
branch_labels = None
depends_on = None


def upgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.create_table('core_sec10k__parents_and_subsidiaries',
    sa.Column('company_id_sec10k', sa.Text(), nullable=True, comment='PUDL-assigned ID for companies that file SEC Form 10-K or are referenced in exhibit 21 attachments to Form 10-K. May not be stable over time.'),
    sa.Column('filename_sec10k', sa.Text(), nullable=True, comment='Name of filing as provided by SEC data portal.'),
    sa.Column('report_date', sa.Date(), nullable=True, comment='Date reported.'),
    sa.Column('central_index_key', sa.Text(), nullable=True, comment='Identifier of the company in SEC database.'),
    sa.Column('utility_id_eia', sa.Integer(), nullable=True, comment='The EIA Utility Identification number.'),
    sa.Column('street_address', sa.Text(), nullable=True, comment='Physical street address.'),
    sa.Column('address_2', sa.Text(), nullable=True, comment='Second line of the address.'),
    sa.Column('city', sa.Text(), nullable=True, comment='Name of the city.'),
    sa.Column('state', sa.Text(), nullable=True, comment='Two letter US state abbreviation.'),
    sa.Column('company_name_raw', sa.Text(), nullable=True, comment='Uncleaned name of company.'),
    sa.Column('name_change_date', sa.Date(), nullable=True, comment='Date of last name change of the company.'),
    sa.Column('company_name_old', sa.Text(), nullable=True, comment='Name of company prior to name change.'),
    sa.Column('industry_name_sic', sa.Text(), nullable=True, comment='Text description of Standard Industrial Classification (SIC)'),
    sa.Column('industry_id_sic', sa.Text(), nullable=True, comment="Four-digit Standard Industrial Classification (SIC) code identifying the company's primary industry. SIC codes have been replaced by NAICS codes in many applications, but are still used by the SEC. See e.g. https://www.osha.gov/data/sic-manual for code definitions."),
    sa.Column('incorporation_state', sa.Text(), nullable=True, comment='Two letter state code where company is incorporated.'),
    sa.Column('location_of_incorporation', sa.Text(), nullable=True, comment='Cleaned location of incorporation of the company.'),
    sa.Column('taxpayer_id_irs', sa.Text(), nullable=True, comment='Taxpayer ID of the company with the IRS.'),
    sa.Column('files_sec10k', sa.Boolean(), nullable=True, comment='Indicates whether the company files an SEC 10-K.'),
    sa.Column('parent_company_central_index_key', sa.Text(), nullable=True, comment="Central index key (CIK) of the company's parent company."),
    sa.Column('fraction_owned', sa.Float(), nullable=True, comment='Proportion of generator ownership attributable to this utility.'),
    sa.ForeignKeyConstraint(['utility_id_eia', 'report_date'], ['core_eia860__scd_utilities.utility_id_eia', 'core_eia860__scd_utilities.report_date'], name=op.f('fk_core_sec10k__parents_and_subsidiaries_utility_id_eia_core_eia860__scd_utilities'))
    )
    op.drop_table('out_sec10k__parents_and_subsidiaries')
    # ### end Alembic commands ###


def downgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.create_table('out_sec10k__parents_and_subsidiaries',
    sa.Column('filename_sec10k', sa.TEXT(), nullable=True),
    sa.Column('report_date', sa.DATE(), nullable=True),
    sa.Column('central_index_key', sa.TEXT(), nullable=True),
    sa.Column('utility_id_eia', sa.INTEGER(), nullable=True),
    sa.Column('street_address', sa.TEXT(), nullable=True),
    sa.Column('address_2', sa.TEXT(), nullable=True),
    sa.Column('city', sa.TEXT(), nullable=True),
    sa.Column('state', sa.TEXT(), nullable=True),
    sa.Column('company_name_raw', sa.TEXT(), nullable=True),
    sa.Column('industry_id_sic', sa.TEXT(), nullable=True),
    sa.Column('location_of_incorporation', sa.TEXT(), nullable=True),
    sa.Column('files_sec10k', sa.BOOLEAN(), nullable=True),
    sa.Column('parent_company_central_index_key', sa.TEXT(), nullable=True),
    sa.Column('fraction_owned', sa.FLOAT(), nullable=True),
    sa.Column('name_change_date', sa.DATE(), nullable=True),
    sa.Column('company_id_sec10k', sa.TEXT(), nullable=True),
    sa.Column('industry_name_sic', sa.TEXT(), nullable=True),
    sa.Column('taxpayer_id_irs', sa.TEXT(), nullable=True),
    sa.Column('company_name_old', sa.TEXT(), nullable=True),
    sa.Column('incorporation_state', sa.TEXT(), nullable=True),
    sa.ForeignKeyConstraint(['utility_id_eia'], ['core_eia__entity_utilities.utility_id_eia'], name='fk_out_sec10k__parents_and_subsidiaries_utility_id_eia_core_eia__entity_utilities')
    )
    op.drop_table('core_sec10k__parents_and_subsidiaries')
    # ### end Alembic commands ###
