"""Add EIA 923 byproduct disposition table

Revision ID: d236fdf360d6
Revises: af82802f2b64
Create Date: 2025-07-30 17:47:44.517097

"""
from alembic import op
import sqlalchemy as sa


# revision identifiers, used by Alembic.
revision = 'd236fdf360d6'
down_revision = 'af82802f2b64'
branch_labels = None
depends_on = None


def upgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.create_table('_core_eia923__yearly_byproduct_disposition',
    sa.Column('byproduct_description', sa.Enum('Ash from coal gasification (IGCC) units', 'Bottom ash from standard boiler units', 'Bottom (bed) ash from FBC units', 'FGD Gypsum', 'Fly ash from FBC units', 'Fly ash from standard boiler/PCD units', 'Fly ash from units with dry FGD', 'Other FGD byproducts', 'Other (specify via footnote on Schedule 9)', 'Steam Sales (MMBtu)'), nullable=False, comment='Description of combustion by-product.'),
    sa.Column('no_byproducts_to_report', sa.Text(), nullable=True, comment="Whether combustion by-products were produced. 'Y' indicates no byproducts to report. The 'Y' and 'N' values do not align with expected values of reported byproducts. This column is messy and requires standardization."),
    sa.Column('disposal_landfill_tons', sa.Integer(), nullable=True, comment='Disposed by-products in landfill, to the nearest 0.1 thousand ton.'),
    sa.Column('disposal_offsite_tons', sa.Integer(), nullable=True, comment='Disposed by-products offsite, to the nearest 0.1 thousand ton.'),
    sa.Column('disposal_ponds_tons', sa.Integer(), nullable=True, comment='Disposed by-products in ponds, to the nearest 0.1 thousand ton.'),
    sa.Column('plant_id_eia', sa.Integer(), nullable=False, comment='The unique six-digit facility identification number, also called an ORISPL, assigned by the Energy Information Administration.'),
    sa.Column('report_year', sa.Integer(), nullable=False, comment='Four-digit year in which the data was reported.'),
    sa.Column('sold_tons_or_mmbtu', sa.Float(), nullable=True, comment='Sold by-products, in tons (to the nearest 0.1 thousand ton) or, for Steam, MMBtu.'),
    sa.Column('stored_offsite_tons', sa.Integer(), nullable=True, comment='Stored by-products offsite, to the nearest 0.1 thousand ton.'),
    sa.Column('stored_onsite_tons', sa.Integer(), nullable=True, comment='Stored by-products onsite, to the nearest 0.1 thousand ton.'),
    sa.Column('total_disposal_tons', sa.Integer(), nullable=True, comment='Total by-product disposal, to the nearest 0.1 thousand ton.'),
    sa.Column('used_offsite_tons', sa.Integer(), nullable=True, comment='Used offsite by-products, to the nearest 0.1 thousand ton.'),
    sa.Column('used_onsite_tons', sa.Integer(), nullable=True, comment='Used onsite by-products, to the nearest 0.1 thousand ton.'),
    sa.Column('data_maturity', sa.Text(), nullable=True, comment='Maturity of the source data published by EIA that is reflected in this record. EIA releases data incrementally over time, including monthly updates, annual year-to-date updates, provisional early releases of annual data, and final annual release data that is not expected to change further. Records sourced from multiple upstream EIA datasets may have no well defined data maturity. Records whose values have been inferred within PUDL will also have no data maturity.'),
    sa.ForeignKeyConstraint(['data_maturity'], ['core_pudl__codes_data_maturities.code'], name=op.f('fk__core_eia923__yearly_byproduct_disposition_data_maturity_core_pudl__codes_data_maturities')),
    sa.ForeignKeyConstraint(['plant_id_eia'], ['core_eia__entity_plants.plant_id_eia'], name=op.f('fk__core_eia923__yearly_byproduct_disposition_plant_id_eia_core_eia__entity_plants')),
    sa.PrimaryKeyConstraint('plant_id_eia', 'report_year', 'byproduct_description', name=op.f('pk__core_eia923__yearly_byproduct_disposition'))
    )
    # ### end Alembic commands ###


def downgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_table('_core_eia923__yearly_byproduct_disposition')
    # ### end Alembic commands ###
