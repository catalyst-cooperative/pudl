"""Add MCOE yearly and monthly tables.

Revision ID: e257545db8de
Revises: c80cfdca0cb7
Create Date: 2023-04-30 22:37:33.652808
"""
import sqlalchemy as sa
from alembic import op

# revision identifiers, used by Alembic.
revision = "e257545db8de"
down_revision = "c80cfdca0cb7"
branch_labels = None
depends_on = None


def upgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.create_table(
        "mcoe_monthly",
        sa.Column(
            "plant_id_eia",
            sa.Integer(),
            nullable=False,
            comment="The unique six-digit facility identification number, also called an ORISPL, assigned by the Energy Information Administration.",
        ),
        sa.Column(
            "generator_id",
            sa.Text(),
            nullable=False,
            comment="Generator ID is usually numeric, but sometimes includes letters. Make sure you treat it as a string!",
        ),
        sa.Column("report_date", sa.Date(), nullable=False, comment="Date reported."),
        sa.Column(
            "unit_id_pudl",
            sa.Integer(),
            nullable=True,
            comment="Dynamically assigned PUDL unit id. WARNING: This ID is not guaranteed to be static long term as the input data and algorithm may evolve over time.",
        ),
        sa.Column(
            "plant_id_pudl",
            sa.Integer(),
            nullable=True,
            comment="A manually assigned PUDL plant ID. May not be constant over time.",
        ),
        sa.Column("plant_name_eia", sa.Text(), nullable=True, comment="Plant name."),
        sa.Column(
            "utility_id_eia",
            sa.Integer(),
            nullable=True,
            comment="The EIA Utility Identification number.",
        ),
        sa.Column(
            "utility_id_pudl",
            sa.Integer(),
            nullable=True,
            comment="A manually assigned PUDL utility ID. May not be stable over time.",
        ),
        sa.Column(
            "utility_name_eia",
            sa.Text(),
            nullable=True,
            comment="The name of the utility.",
        ),
        sa.Column(
            "technology_description",
            sa.Text(),
            nullable=True,
            comment="High level description of the technology used by the generator to produce electricity.",
        ),
        sa.Column(
            "energy_source_code_1",
            sa.Text(),
            nullable=True,
            comment="The code representing the most predominant type of energy that fuels the generator.",
        ),
        sa.Column(
            "prime_mover_code",
            sa.Text(),
            nullable=True,
            comment="Code for the type of prime mover (e.g. CT, CG)",
        ),
        sa.Column(
            "generator_operating_date",
            sa.Date(),
            nullable=True,
            comment="Date the generator began commercial operation.",
        ),
        sa.Column(
            "generator_retirement_date",
            sa.Date(),
            nullable=True,
            comment="Date of the scheduled or effected retirement of the generator.",
        ),
        sa.Column(
            "operational_status",
            sa.Text(),
            nullable=True,
            comment="The operating status of the generator. This is based on which tab the generator was listed in in EIA 860.",
        ),
        sa.Column(
            "capacity_mw",
            sa.Float(),
            nullable=True,
            comment="Total installed (nameplate) capacity, in megawatts.",
        ),
        sa.Column(
            "fuel_type_code_pudl",
            sa.Enum(
                "coal",
                "gas",
                "hydro",
                "nuclear",
                "oil",
                "other",
                "solar",
                "waste",
                "wind",
            ),
            nullable=True,
            comment="Simplified fuel type code used in PUDL",
        ),
        sa.Column(
            "planned_generator_retirement_date",
            sa.Date(),
            nullable=True,
            comment="Planned effective date of the scheduled retirement of the generator.",
        ),
        sa.Column(
            "capacity_factor",
            sa.Float(),
            nullable=True,
            comment="Fraction of potential generation that was actually reported for a plant part.",
        ),
        sa.Column(
            "fuel_cost_from_eiaapi",
            sa.Boolean(),
            nullable=True,
            comment="Indicates whether the fuel cost was derived from the EIA API.",
        ),
        sa.Column(
            "fuel_cost_per_mmbtu",
            sa.Float(),
            nullable=True,
            comment="Average fuel cost per mmBTU of heat content in nominal USD.",
        ),
        sa.Column(
            "fuel_cost_per_mwh",
            sa.Float(),
            nullable=True,
            comment="Derived from MCOE, a unit level value. Average fuel cost per MWh of heat content in nominal USD.",
        ),
        sa.Column(
            "heat_rate_mmbtu_mwh",
            sa.Float(),
            nullable=True,
            comment="Fuel content per unit of electricity generated. Coming from MCOE calculation.",
        ),
        sa.Column(
            "net_generation_mwh",
            sa.Float(),
            nullable=True,
            comment="Net electricity generation for the specified period in megawatt-hours (MWh).",
        ),
        sa.Column(
            "total_fuel_cost",
            sa.Float(),
            nullable=True,
            comment="Total annual reported fuel costs for the plant part. Includes costs from all fuels.",
        ),
        sa.Column(
            "total_mmbtu",
            sa.Float(),
            nullable=True,
            comment="Total annual heat content of fuel consumed by a plant part record in the plant parts list.",
        ),
        sa.ForeignKeyConstraint(
            ["energy_source_code_1"],
            ["energy_sources_eia.code"],
        ),
        sa.ForeignKeyConstraint(
            ["plant_id_eia", "generator_id", "report_date"],
            [
                "generators_eia860.plant_id_eia",
                "generators_eia860.generator_id",
                "generators_eia860.report_date",
            ],
        ),
        sa.ForeignKeyConstraint(
            ["plant_id_pudl"],
            ["plants_pudl.plant_id_pudl"],
        ),
        sa.ForeignKeyConstraint(
            ["prime_mover_code"],
            ["prime_movers_eia.code"],
        ),
        sa.ForeignKeyConstraint(
            ["utility_id_eia", "report_date"],
            ["utilities_eia860.utility_id_eia", "utilities_eia860.report_date"],
        ),
        sa.ForeignKeyConstraint(
            ["utility_id_pudl"],
            ["utilities_pudl.utility_id_pudl"],
        ),
        sa.PrimaryKeyConstraint("report_date", "plant_id_eia", "generator_id"),
    )
    op.create_table(
        "mcoe_yearly",
        sa.Column(
            "plant_id_eia",
            sa.Integer(),
            nullable=False,
            comment="The unique six-digit facility identification number, also called an ORISPL, assigned by the Energy Information Administration.",
        ),
        sa.Column(
            "generator_id",
            sa.Text(),
            nullable=False,
            comment="Generator ID is usually numeric, but sometimes includes letters. Make sure you treat it as a string!",
        ),
        sa.Column("report_date", sa.Date(), nullable=False, comment="Date reported."),
        sa.Column(
            "unit_id_pudl",
            sa.Integer(),
            nullable=True,
            comment="Dynamically assigned PUDL unit id. WARNING: This ID is not guaranteed to be static long term as the input data and algorithm may evolve over time.",
        ),
        sa.Column(
            "plant_id_pudl",
            sa.Integer(),
            nullable=True,
            comment="A manually assigned PUDL plant ID. May not be constant over time.",
        ),
        sa.Column("plant_name_eia", sa.Text(), nullable=True, comment="Plant name."),
        sa.Column(
            "utility_id_eia",
            sa.Integer(),
            nullable=True,
            comment="The EIA Utility Identification number.",
        ),
        sa.Column(
            "utility_id_pudl",
            sa.Integer(),
            nullable=True,
            comment="A manually assigned PUDL utility ID. May not be stable over time.",
        ),
        sa.Column(
            "utility_name_eia",
            sa.Text(),
            nullable=True,
            comment="The name of the utility.",
        ),
        sa.Column(
            "technology_description",
            sa.Text(),
            nullable=True,
            comment="High level description of the technology used by the generator to produce electricity.",
        ),
        sa.Column(
            "energy_source_code_1",
            sa.Text(),
            nullable=True,
            comment="The code representing the most predominant type of energy that fuels the generator.",
        ),
        sa.Column(
            "prime_mover_code",
            sa.Text(),
            nullable=True,
            comment="Code for the type of prime mover (e.g. CT, CG)",
        ),
        sa.Column(
            "generator_operating_date",
            sa.Date(),
            nullable=True,
            comment="Date the generator began commercial operation.",
        ),
        sa.Column(
            "generator_retirement_date",
            sa.Date(),
            nullable=True,
            comment="Date of the scheduled or effected retirement of the generator.",
        ),
        sa.Column(
            "operational_status",
            sa.Text(),
            nullable=True,
            comment="The operating status of the generator. This is based on which tab the generator was listed in in EIA 860.",
        ),
        sa.Column(
            "capacity_mw",
            sa.Float(),
            nullable=True,
            comment="Total installed (nameplate) capacity, in megawatts.",
        ),
        sa.Column(
            "fuel_type_code_pudl",
            sa.Enum(
                "coal",
                "gas",
                "hydro",
                "nuclear",
                "oil",
                "other",
                "solar",
                "waste",
                "wind",
            ),
            nullable=True,
            comment="Simplified fuel type code used in PUDL",
        ),
        sa.Column(
            "planned_generator_retirement_date",
            sa.Date(),
            nullable=True,
            comment="Planned effective date of the scheduled retirement of the generator.",
        ),
        sa.Column(
            "capacity_factor",
            sa.Float(),
            nullable=True,
            comment="Fraction of potential generation that was actually reported for a plant part.",
        ),
        sa.Column(
            "fuel_cost_from_eiaapi",
            sa.Boolean(),
            nullable=True,
            comment="Indicates whether the fuel cost was derived from the EIA API.",
        ),
        sa.Column(
            "fuel_cost_per_mmbtu",
            sa.Float(),
            nullable=True,
            comment="Average fuel cost per mmBTU of heat content in nominal USD.",
        ),
        sa.Column(
            "fuel_cost_per_mwh",
            sa.Float(),
            nullable=True,
            comment="Derived from MCOE, a unit level value. Average fuel cost per MWh of heat content in nominal USD.",
        ),
        sa.Column(
            "heat_rate_mmbtu_mwh",
            sa.Float(),
            nullable=True,
            comment="Fuel content per unit of electricity generated. Coming from MCOE calculation.",
        ),
        sa.Column(
            "net_generation_mwh",
            sa.Float(),
            nullable=True,
            comment="Net electricity generation for the specified period in megawatt-hours (MWh).",
        ),
        sa.Column(
            "total_fuel_cost",
            sa.Float(),
            nullable=True,
            comment="Total annual reported fuel costs for the plant part. Includes costs from all fuels.",
        ),
        sa.Column(
            "total_mmbtu",
            sa.Float(),
            nullable=True,
            comment="Total annual heat content of fuel consumed by a plant part record in the plant parts list.",
        ),
        sa.ForeignKeyConstraint(
            ["energy_source_code_1"],
            ["energy_sources_eia.code"],
        ),
        sa.ForeignKeyConstraint(
            ["plant_id_eia", "generator_id", "report_date"],
            [
                "generators_eia860.plant_id_eia",
                "generators_eia860.generator_id",
                "generators_eia860.report_date",
            ],
        ),
        sa.ForeignKeyConstraint(
            ["plant_id_pudl"],
            ["plants_pudl.plant_id_pudl"],
        ),
        sa.ForeignKeyConstraint(
            ["prime_mover_code"],
            ["prime_movers_eia.code"],
        ),
        sa.ForeignKeyConstraint(
            ["utility_id_eia", "report_date"],
            ["utilities_eia860.utility_id_eia", "utilities_eia860.report_date"],
        ),
        sa.ForeignKeyConstraint(
            ["utility_id_pudl"],
            ["utilities_pudl.utility_id_pudl"],
        ),
        sa.PrimaryKeyConstraint("report_date", "plant_id_eia", "generator_id"),
    )
    # ### end Alembic commands ###


def downgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_table("mcoe_yearly")
    op.drop_table("mcoe_monthly")
    # ### end Alembic commands ###
