<!doctype html>
<html class="no-js" lang="en" data-content_root="../../../">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-EXWBBTVMWK"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-EXWBBTVMWK');
    </script>
    <link rel="index" title="Index" href="../../../genindex.html"><link rel="search" title="Search" href="../../../search.html"><link rel="next" title="pudl.io_managers" href="../io_managers/index.html"><link rel="prev" title="pudl.glue.ferc714" href="../glue/ferc714/index.html">
        <link rel="prefetch" href="../../../_static/catalyst_logo-200x200.png" as="image">

    <!-- Generated with Sphinx 9.1.0 and Furo 2025.12.19 -->
        <title>pudl.helpers - PUDL 2026.2.1.dev10 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?v=7bdb33bb" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css?v=b1990d62" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  --color-announcement-background: yellow;
  --color-announcement-text: red;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-announcement-background: yellow;
  --color-announcement-text: red;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-announcement-background: yellow;
  --color-announcement-text: red;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>

<div class="announcement">
  <aside class="announcement-content">
     <b>Take our ~10 minute <a href="https://forms.gle/E9ou5fgMcR7YVRCRA">2026 Energy Data Ecosystem Survey!</b> 
  </aside>
</div>

<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">PUDL 2026.2.1.dev10 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../index.html">
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../../_static/catalyst_logo-200x200.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">PUDL 2026.2.1.dev10 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">About PUDL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../data_access.html">Data Access</a></li>
<li class="toctree-l1"><a class="reference external" href="https://data.catalyst.coop">PUDL Data Viewer</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../data_sources/index.html">Data Sources</a><input aria-label="Toggle navigation of Data Sources" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../data_sources/censusdp1tract.html">Census DP1 – Profile of General Demographic Characteristics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../data_sources/censuspep.html">Population Estimates Program's (PEP) Federal Information Processing Series (FIPS) Codes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../data_sources/eiaapi.html">EIA Bulk API Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../data_sources/eia176.html">EIA Form 176 – Annual Report of Natural and Supplemental Gas Supply and Disposition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../data_sources/eia860.html">EIA Form 860 – Annual Electric Generator Report</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../data_sources/eia861.html">EIA Form 861 – Annual Electric Power Industry Report</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../data_sources/eia923.html">EIA Form 923 – Power Plant Operations Report</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../data_sources/eia930.html">EIA Form 930 – Hourly and Daily Balancing Authority Operations Report</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../data_sources/eiaaeo.html">EIA Annual Energy Outlook (AEO)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../data_sources/epacamd_eia.html">EPA CAMD to EIA Power Sector Data Crosswalk</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../data_sources/epacems.html">EPA Hourly Continuous Emission Monitoring System (CEMS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../data_sources/ferc1.html">FERC Form 1 – Annual Report of Major Electric Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../data_sources/ferc714.html">FERC Form 714 – Annual Electric Balancing Authority Area and Planning Area Report</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../data_sources/ferceqr.html">FERC Form 920 – Electric Quarterly Report (EQR)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../data_sources/gridpathratoolkit.html">GridPath Resource Adequacy Toolkit Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../data_sources/nrelatb.html">NREL Annual Technology Baseline (ATB) for Electricity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../data_sources/phmsagas.html">Pipelines and Hazardous Materials Safety Administration (PHMSA) Annual Natural Gas Report</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../data_sources/rus12.html">USDA RUS Form 12 – Financial and Operating Report: Electric Power Supply</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../data_sources/rus7.html">USDA RUS Form 7 – Financial and Operating Report: Electric Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../data_sources/sec10k.html">U.S. Securities and Exchange Commission (SEC) Form 10-K</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../data_sources/vcerare.html">Vibrant Clean Energy Resource Adequacy Renewable Energy (RARE) Power Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../data_sources/other_data.html">Other Data in PUDL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../data_sources/future_data.html">High Priority Target Datasets</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../data_dictionaries/index.html">Data Dictionaries</a><input aria-label="Toggle navigation of Data Dictionaries" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../data_dictionaries/pudl_db.html">PUDL Data Dictionary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../data_dictionaries/ferc1_db.html">Raw FERC Form 1 Data Dictionary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../data_dictionaries/codes_and_labels.html">PUDL Code Metadata</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../data_dictionaries/usage_warnings.html">PUDL Usage Warnings</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../methodology/index.html">Methodology</a><input aria-label="Toggle navigation of Methodology" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../methodology/timeseries_imputation.html">Timeseries Imputation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../methodology/sec10k_modeling.html">SEC 10-K Ownership Data Extraction Modeling</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../CONTRIBUTING.html">Contributing</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../dev/index.html">Development</a><input aria-label="Toggle navigation of Development" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../dev/dev_setup.html">Development Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../dev/run_the_etl.html">Running the ETL Pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../dev/dev_dagster.html">Developing with Dagster</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../dev/project_management.html">Project Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../dev/testing.html">Testing PUDL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../dev/data_validation_quickstart.html">Data validation quickstart</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../dev/data_validation_reference.html">Data validation reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../dev/metadata.html">Metadata editing guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../dev/build_docs.html">Building the Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../dev/datastore.html">Working with the Datastore</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../dev/clone_ferc1.html">Converting raw FERC data to SQLite</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../dev/existing_data_updates.html">Existing Data Updates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../dev/run_a_release.html">Run a Versioned Release</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../dev/pudl_id_mapping.html">PUDL ID Mapping</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../dev/naming_conventions.html">Naming Conventions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../dev/data_guidelines.html">Data and ETL Design Guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../dev/nightly_data_builds.html">Nightly Data Builds</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../dev/ferceqr_data_builds.html">FERC EQR Data Builds</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../dev/infrastructure_as_code.html">Infrastructure as Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../dev/managing_external_contributions.html">Managing External Contributions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../LICENSE.html">Licensing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../code_of_conduct.html">Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../release_notes.html">Release Notes</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../../index.html">API Reference</a><input aria-label="Toggle navigation of API Reference" checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul class="current">
<li class="toctree-l2 current has-children"><a class="reference internal" href="../index.html">pudl</a><input aria-label="Toggle navigation of pudl" checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../__main__/index.html">pudl.__main__</a></li>
<li class="toctree-l3"><a class="reference internal" href="../_version/index.html">pudl._version</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../analysis/index.html">pudl.analysis</a><input aria-label="Toggle navigation of pudl.analysis" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../analysis/allocate_gen_fuel/index.html">pudl.analysis.allocate_gen_fuel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../analysis/fuel_by_plant/index.html">pudl.analysis.fuel_by_plant</a></li>
<li class="toctree-l4"><a class="reference internal" href="../analysis/mcoe/index.html">pudl.analysis.mcoe</a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../analysis/ml_tools/index.html">pudl.analysis.ml_tools</a><input aria-label="Toggle navigation of pudl.analysis.ml_tools" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../analysis/ml_tools/experiment_tracking/index.html">pudl.analysis.ml_tools.experiment_tracking</a></li>
<li class="toctree-l5"><a class="reference internal" href="../analysis/ml_tools/models/index.html">pudl.analysis.ml_tools.models</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../analysis/plant_parts_eia/index.html">pudl.analysis.plant_parts_eia</a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../analysis/record_linkage/index.html">pudl.analysis.record_linkage</a><input aria-label="Toggle navigation of pudl.analysis.record_linkage" class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../analysis/record_linkage/classify_plants_ferc1/index.html">pudl.analysis.record_linkage.classify_plants_ferc1</a></li>
<li class="toctree-l5"><a class="reference internal" href="../analysis/record_linkage/eia_ferc1_inputs/index.html">pudl.analysis.record_linkage.eia_ferc1_inputs</a></li>
<li class="toctree-l5"><a class="reference internal" href="../analysis/record_linkage/eia_ferc1_model_config/index.html">pudl.analysis.record_linkage.eia_ferc1_model_config</a></li>
<li class="toctree-l5"><a class="reference internal" href="../analysis/record_linkage/eia_ferc1_record_linkage/index.html">pudl.analysis.record_linkage.eia_ferc1_record_linkage</a></li>
<li class="toctree-l5"><a class="reference internal" href="../analysis/record_linkage/eia_ferc1_train/index.html">pudl.analysis.record_linkage.eia_ferc1_train</a></li>
<li class="toctree-l5"><a class="reference internal" href="../analysis/record_linkage/embed_dataframe/index.html">pudl.analysis.record_linkage.embed_dataframe</a></li>
<li class="toctree-l5"><a class="reference internal" href="../analysis/record_linkage/link_cross_year/index.html">pudl.analysis.record_linkage.link_cross_year</a></li>
<li class="toctree-l5"><a class="reference internal" href="../analysis/record_linkage/name_cleaner/index.html">pudl.analysis.record_linkage.name_cleaner</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../analysis/service_territory/index.html">pudl.analysis.service_territory</a></li>
<li class="toctree-l4"><a class="reference internal" href="../analysis/spatial/index.html">pudl.analysis.spatial</a></li>
<li class="toctree-l4"><a class="reference internal" href="../analysis/state_demand/index.html">pudl.analysis.state_demand</a></li>
<li class="toctree-l4"><a class="reference internal" href="../analysis/timeseries_cleaning/index.html">pudl.analysis.timeseries_cleaning</a></li>
<li class="toctree-l4"><a class="reference internal" href="../analysis/timeseries_evaluation/index.html">pudl.analysis.timeseries_evaluation</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../convert/index.html">pudl.convert</a><input aria-label="Toggle navigation of pudl.convert" class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../convert/censusdp1tract_to_sqlite/index.html">pudl.convert.censusdp1tract_to_sqlite</a></li>
<li class="toctree-l4"><a class="reference internal" href="../convert/metadata_to_rst/index.html">pudl.convert.metadata_to_rst</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../dbt_wrapper/index.html">pudl.dbt_wrapper</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../etl/index.html">pudl.etl</a><input aria-label="Toggle navigation of pudl.etl" class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../etl/asset_checks/index.html">pudl.etl.asset_checks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../etl/check_foreign_keys/index.html">pudl.etl.check_foreign_keys</a></li>
<li class="toctree-l4"><a class="reference internal" href="../etl/cli/index.html">pudl.etl.cli</a></li>
<li class="toctree-l4"><a class="reference internal" href="../etl/eia_bulk_elec_assets/index.html">pudl.etl.eia_bulk_elec_assets</a></li>
<li class="toctree-l4"><a class="reference internal" href="../etl/ferceqr_deployment/index.html">pudl.etl.ferceqr_deployment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../etl/glue_assets/index.html">pudl.etl.glue_assets</a></li>
<li class="toctree-l4"><a class="reference internal" href="../etl/static_assets/index.html">pudl.etl.static_assets</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../extract/index.html">pudl.extract</a><input aria-label="Toggle navigation of pudl.extract" class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../extract/censuspep/index.html">pudl.extract.censuspep</a></li>
<li class="toctree-l4"><a class="reference internal" href="../extract/csv/index.html">pudl.extract.csv</a></li>
<li class="toctree-l4"><a class="reference internal" href="../extract/dbf/index.html">pudl.extract.dbf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../extract/eia176/index.html">pudl.extract.eia176</a></li>
<li class="toctree-l4"><a class="reference internal" href="../extract/eia191/index.html">pudl.extract.eia191</a></li>
<li class="toctree-l4"><a class="reference internal" href="../extract/eia757a/index.html">pudl.extract.eia757a</a></li>
<li class="toctree-l4"><a class="reference internal" href="../extract/eia860/index.html">pudl.extract.eia860</a></li>
<li class="toctree-l4"><a class="reference internal" href="../extract/eia860m/index.html">pudl.extract.eia860m</a></li>
<li class="toctree-l4"><a class="reference internal" href="../extract/eia861/index.html">pudl.extract.eia861</a></li>
<li class="toctree-l4"><a class="reference internal" href="../extract/eia923/index.html">pudl.extract.eia923</a></li>
<li class="toctree-l4"><a class="reference internal" href="../extract/eia930/index.html">pudl.extract.eia930</a></li>
<li class="toctree-l4"><a class="reference internal" href="../extract/eiaaeo/index.html">pudl.extract.eiaaeo</a></li>
<li class="toctree-l4"><a class="reference internal" href="../extract/eiaapi/index.html">pudl.extract.eiaapi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../extract/epacems/index.html">pudl.extract.epacems</a></li>
<li class="toctree-l4"><a class="reference internal" href="../extract/excel/index.html">pudl.extract.excel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../extract/extractor/index.html">pudl.extract.extractor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../extract/ferc/index.html">pudl.extract.ferc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../extract/ferc1/index.html">pudl.extract.ferc1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../extract/ferc2/index.html">pudl.extract.ferc2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../extract/ferc6/index.html">pudl.extract.ferc6</a></li>
<li class="toctree-l4"><a class="reference internal" href="../extract/ferc60/index.html">pudl.extract.ferc60</a></li>
<li class="toctree-l4"><a class="reference internal" href="../extract/ferc714/index.html">pudl.extract.ferc714</a></li>
<li class="toctree-l4"><a class="reference internal" href="../extract/ferccid/index.html">pudl.extract.ferccid</a></li>
<li class="toctree-l4"><a class="reference internal" href="../extract/ferceqr/index.html">pudl.extract.ferceqr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../extract/gridpathratoolkit/index.html">pudl.extract.gridpathratoolkit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../extract/nrelatb/index.html">pudl.extract.nrelatb</a></li>
<li class="toctree-l4"><a class="reference internal" href="../extract/parquet/index.html">pudl.extract.parquet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../extract/phmsagas/index.html">pudl.extract.phmsagas</a></li>
<li class="toctree-l4"><a class="reference internal" href="../extract/rus12/index.html">pudl.extract.rus12</a></li>
<li class="toctree-l4"><a class="reference internal" href="../extract/rus7/index.html">pudl.extract.rus7</a></li>
<li class="toctree-l4"><a class="reference internal" href="../extract/sec10k/index.html">pudl.extract.sec10k</a></li>
<li class="toctree-l4"><a class="reference internal" href="../extract/vcerare/index.html">pudl.extract.vcerare</a></li>
<li class="toctree-l4"><a class="reference internal" href="../extract/xbrl/index.html">pudl.extract.xbrl</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../ferc_to_sqlite/index.html">pudl.ferc_to_sqlite</a><input aria-label="Toggle navigation of pudl.ferc_to_sqlite" class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../ferc_to_sqlite/cli/index.html">pudl.ferc_to_sqlite.cli</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../glue/index.html">pudl.glue</a><input aria-label="Toggle navigation of pudl.glue" class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../glue/ferc1_eia/index.html">pudl.glue.ferc1_eia</a></li>
<li class="toctree-l4"><a class="reference internal" href="../glue/ferc714/index.html">pudl.glue.ferc714</a></li>
</ul>
</li>
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">pudl.helpers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../io_managers/index.html">pudl.io_managers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../logging_helpers/index.html">pudl.logging_helpers</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../metadata/index.html">pudl.metadata</a><input aria-label="Toggle navigation of pudl.metadata" class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../metadata/classes/index.html">pudl.metadata.classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../metadata/codes/index.html">pudl.metadata.codes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../metadata/constants/index.html">pudl.metadata.constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../metadata/descriptions/index.html">pudl.metadata.descriptions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../metadata/dfs/index.html">pudl.metadata.dfs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../metadata/enums/index.html">pudl.metadata.enums</a></li>
<li class="toctree-l4"><a class="reference internal" href="../metadata/fields/index.html">pudl.metadata.fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="../metadata/helpers/index.html">pudl.metadata.helpers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../metadata/labels/index.html">pudl.metadata.labels</a></li>
<li class="toctree-l4"><a class="reference internal" href="../metadata/resource_helpers/index.html">pudl.metadata.resource_helpers</a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../metadata/resources/index.html">pudl.metadata.resources</a><input aria-label="Toggle navigation of pudl.metadata.resources" class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../metadata/resources/allocate_gen_fuel/index.html">pudl.metadata.resources.allocate_gen_fuel</a></li>
<li class="toctree-l5"><a class="reference internal" href="../metadata/resources/censusdp1tract/index.html">pudl.metadata.resources.censusdp1tract</a></li>
<li class="toctree-l5"><a class="reference internal" href="../metadata/resources/eia/index.html">pudl.metadata.resources.eia</a></li>
<li class="toctree-l5"><a class="reference internal" href="../metadata/resources/eia176/index.html">pudl.metadata.resources.eia176</a></li>
<li class="toctree-l5"><a class="reference internal" href="../metadata/resources/eia860/index.html">pudl.metadata.resources.eia860</a></li>
<li class="toctree-l5"><a class="reference internal" href="../metadata/resources/eia860m/index.html">pudl.metadata.resources.eia860m</a></li>
<li class="toctree-l5"><a class="reference internal" href="../metadata/resources/eia861/index.html">pudl.metadata.resources.eia861</a></li>
<li class="toctree-l5"><a class="reference internal" href="../metadata/resources/eia923/index.html">pudl.metadata.resources.eia923</a></li>
<li class="toctree-l5"><a class="reference internal" href="../metadata/resources/eia930/index.html">pudl.metadata.resources.eia930</a></li>
<li class="toctree-l5"><a class="reference internal" href="../metadata/resources/eiaaeo/index.html">pudl.metadata.resources.eiaaeo</a></li>
<li class="toctree-l5"><a class="reference internal" href="../metadata/resources/eiaapi/index.html">pudl.metadata.resources.eiaapi</a></li>
<li class="toctree-l5"><a class="reference internal" href="../metadata/resources/epacems/index.html">pudl.metadata.resources.epacems</a></li>
<li class="toctree-l5"><a class="reference internal" href="../metadata/resources/ferc1/index.html">pudl.metadata.resources.ferc1</a></li>
<li class="toctree-l5"><a class="reference internal" href="../metadata/resources/ferc1_eia_record_linkage/index.html">pudl.metadata.resources.ferc1_eia_record_linkage</a></li>
<li class="toctree-l5"><a class="reference internal" href="../metadata/resources/ferc714/index.html">pudl.metadata.resources.ferc714</a></li>
<li class="toctree-l5"><a class="reference internal" href="../metadata/resources/ferccid/index.html">pudl.metadata.resources.ferccid</a></li>
<li class="toctree-l5"><a class="reference internal" href="../metadata/resources/ferceqr/index.html">pudl.metadata.resources.ferceqr</a></li>
<li class="toctree-l5"><a class="reference internal" href="../metadata/resources/glue/index.html">pudl.metadata.resources.glue</a></li>
<li class="toctree-l5"><a class="reference internal" href="../metadata/resources/gridpathratoolkit/index.html">pudl.metadata.resources.gridpathratoolkit</a></li>
<li class="toctree-l5"><a class="reference internal" href="../metadata/resources/nrelatb/index.html">pudl.metadata.resources.nrelatb</a></li>
<li class="toctree-l5"><a class="reference internal" href="../metadata/resources/phmsagas/index.html">pudl.metadata.resources.phmsagas</a></li>
<li class="toctree-l5"><a class="reference internal" href="../metadata/resources/pudl/index.html">pudl.metadata.resources.pudl</a></li>
<li class="toctree-l5"><a class="reference internal" href="../metadata/resources/rus12/index.html">pudl.metadata.resources.rus12</a></li>
<li class="toctree-l5"><a class="reference internal" href="../metadata/resources/rus7/index.html">pudl.metadata.resources.rus7</a></li>
<li class="toctree-l5"><a class="reference internal" href="../metadata/resources/sec10k/index.html">pudl.metadata.resources.sec10k</a></li>
<li class="toctree-l5"><a class="reference internal" href="../metadata/resources/vcerare/index.html">pudl.metadata.resources.vcerare</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../metadata/sources/index.html">pudl.metadata.sources</a></li>
<li class="toctree-l4"><a class="reference internal" href="../metadata/warnings/index.html">pudl.metadata.warnings</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../output/index.html">pudl.output</a><input aria-label="Toggle navigation of pudl.output" class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../output/censusdp1tract/index.html">pudl.output.censusdp1tract</a></li>
<li class="toctree-l4"><a class="reference internal" href="../output/eia/index.html">pudl.output.eia</a></li>
<li class="toctree-l4"><a class="reference internal" href="../output/eia860/index.html">pudl.output.eia860</a></li>
<li class="toctree-l4"><a class="reference internal" href="../output/eia923/index.html">pudl.output.eia923</a></li>
<li class="toctree-l4"><a class="reference internal" href="../output/eia930/index.html">pudl.output.eia930</a></li>
<li class="toctree-l4"><a class="reference internal" href="../output/eiaapi/index.html">pudl.output.eiaapi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../output/ferc1/index.html">pudl.output.ferc1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../output/ferc714/index.html">pudl.output.ferc714</a></li>
<li class="toctree-l4"><a class="reference internal" href="../output/sec10k/index.html">pudl.output.sec10k</a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../output/sql/index.html">pudl.output.sql</a><input aria-label="Toggle navigation of pudl.output.sql" class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../output/sql/helpers/index.html">pudl.output.sql.helpers</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../package_data/index.html">pudl.package_data</a><input aria-label="Toggle navigation of pudl.package_data" class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../package_data/censuspep/index.html">pudl.package_data.censuspep</a><input aria-label="Toggle navigation of pudl.package_data.censuspep" class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../package_data/censuspep/column_maps/index.html">pudl.package_data.censuspep.column_maps</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../package_data/eia176/index.html">pudl.package_data.eia176</a><input aria-label="Toggle navigation of pudl.package_data.eia176" class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../package_data/eia176/column_maps/index.html">pudl.package_data.eia176.column_maps</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../package_data/eia191/index.html">pudl.package_data.eia191</a><input aria-label="Toggle navigation of pudl.package_data.eia191" class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../package_data/eia191/column_maps/index.html">pudl.package_data.eia191.column_maps</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../package_data/eia757a/index.html">pudl.package_data.eia757a</a><input aria-label="Toggle navigation of pudl.package_data.eia757a" class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../package_data/eia757a/column_maps/index.html">pudl.package_data.eia757a.column_maps</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../package_data/eia860/index.html">pudl.package_data.eia860</a><input aria-label="Toggle navigation of pudl.package_data.eia860" class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" role="switch" type="checkbox"/><label for="toctree-checkbox-24"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../package_data/eia860/column_maps/index.html">pudl.package_data.eia860.column_maps</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../package_data/eia860m/index.html">pudl.package_data.eia860m</a><input aria-label="Toggle navigation of pudl.package_data.eia860m" class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" role="switch" type="checkbox"/><label for="toctree-checkbox-25"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../package_data/eia860m/column_maps/index.html">pudl.package_data.eia860m.column_maps</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../package_data/eia861/index.html">pudl.package_data.eia861</a><input aria-label="Toggle navigation of pudl.package_data.eia861" class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" role="switch" type="checkbox"/><label for="toctree-checkbox-26"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../package_data/eia861/column_maps/index.html">pudl.package_data.eia861.column_maps</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../package_data/eia923/index.html">pudl.package_data.eia923</a><input aria-label="Toggle navigation of pudl.package_data.eia923" class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" role="switch" type="checkbox"/><label for="toctree-checkbox-27"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../package_data/eia923/column_maps/index.html">pudl.package_data.eia923.column_maps</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../package_data/eia930/index.html">pudl.package_data.eia930</a><input aria-label="Toggle navigation of pudl.package_data.eia930" class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" role="switch" type="checkbox"/><label for="toctree-checkbox-28"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../package_data/eia930/column_maps/index.html">pudl.package_data.eia930.column_maps</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../package_data/epacems/index.html">pudl.package_data.epacems</a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../package_data/ferc1/index.html">pudl.package_data.ferc1</a><input aria-label="Toggle navigation of pudl.package_data.ferc1" class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" role="switch" type="checkbox"/><label for="toctree-checkbox-29"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../package_data/ferc1/row_maps/index.html">pudl.package_data.ferc1.row_maps</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../package_data/glue/index.html">pudl.package_data.glue</a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../package_data/phmsagas/index.html">pudl.package_data.phmsagas</a><input aria-label="Toggle navigation of pudl.package_data.phmsagas" class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" role="switch" type="checkbox"/><label for="toctree-checkbox-30"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../package_data/phmsagas/column_maps/index.html">pudl.package_data.phmsagas.column_maps</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../package_data/rus12/index.html">pudl.package_data.rus12</a><input aria-label="Toggle navigation of pudl.package_data.rus12" class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" role="switch" type="checkbox"/><label for="toctree-checkbox-31"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../package_data/rus12/column_maps/index.html">pudl.package_data.rus12.column_maps</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../package_data/rus7/index.html">pudl.package_data.rus7</a></li>
<li class="toctree-l4"><a class="reference internal" href="../package_data/settings/index.html">pudl.package_data.settings</a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../package_data/test/index.html">pudl.package_data.test</a><input aria-label="Toggle navigation of pudl.package_data.test" class="toctree-checkbox" id="toctree-checkbox-32" name="toctree-checkbox-32" role="switch" type="checkbox"/><label for="toctree-checkbox-32"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../package_data/test/column_maps/index.html">pudl.package_data.test.column_maps</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../package_data/vcerare/index.html">pudl.package_data.vcerare</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../resources/index.html">pudl.resources</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../scripts/index.html">pudl.scripts</a><input aria-label="Toggle navigation of pudl.scripts" class="toctree-checkbox" id="toctree-checkbox-33" name="toctree-checkbox-33" role="switch" type="checkbox"/><label for="toctree-checkbox-33"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../scripts/auto_match_utilities/index.html">pudl.scripts.auto_match_utilities</a></li>
<li class="toctree-l4"><a class="reference internal" href="../scripts/dbt_helper/index.html">pudl.scripts.dbt_helper</a></li>
<li class="toctree-l4"><a class="reference internal" href="../scripts/generate_pudl_duckdb/index.html">pudl.scripts.generate_pudl_duckdb</a></li>
<li class="toctree-l4"><a class="reference internal" href="../scripts/pudl_null_cols/index.html">pudl.scripts.pudl_null_cols</a></li>
<li class="toctree-l4"><a class="reference internal" href="../scripts/resource_description/index.html">pudl.scripts.resource_description</a></li>
<li class="toctree-l4"><a class="reference internal" href="../scripts/zenodo_data_release/index.html">pudl.scripts.zenodo_data_release</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../settings/index.html">pudl.settings</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../transform/index.html">pudl.transform</a><input aria-label="Toggle navigation of pudl.transform" class="toctree-checkbox" id="toctree-checkbox-34" name="toctree-checkbox-34" role="switch" type="checkbox"/><label for="toctree-checkbox-34"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../transform/censuspep/index.html">pudl.transform.censuspep</a></li>
<li class="toctree-l4"><a class="reference internal" href="../transform/classes/index.html">pudl.transform.classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../transform/eia/index.html">pudl.transform.eia</a></li>
<li class="toctree-l4"><a class="reference internal" href="../transform/eia176/index.html">pudl.transform.eia176</a></li>
<li class="toctree-l4"><a class="reference internal" href="../transform/eia860/index.html">pudl.transform.eia860</a></li>
<li class="toctree-l4"><a class="reference internal" href="../transform/eia860m/index.html">pudl.transform.eia860m</a></li>
<li class="toctree-l4"><a class="reference internal" href="../transform/eia861/index.html">pudl.transform.eia861</a></li>
<li class="toctree-l4"><a class="reference internal" href="../transform/eia923/index.html">pudl.transform.eia923</a></li>
<li class="toctree-l4"><a class="reference internal" href="../transform/eia930/index.html">pudl.transform.eia930</a></li>
<li class="toctree-l4"><a class="reference internal" href="../transform/eiaaeo/index.html">pudl.transform.eiaaeo</a></li>
<li class="toctree-l4"><a class="reference internal" href="../transform/eiaapi/index.html">pudl.transform.eiaapi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../transform/epacems/index.html">pudl.transform.epacems</a></li>
<li class="toctree-l4"><a class="reference internal" href="../transform/ferc/index.html">pudl.transform.ferc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../transform/ferc1/index.html">pudl.transform.ferc1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../transform/ferc714/index.html">pudl.transform.ferc714</a></li>
<li class="toctree-l4"><a class="reference internal" href="../transform/ferccid/index.html">pudl.transform.ferccid</a></li>
<li class="toctree-l4"><a class="reference internal" href="../transform/ferceqr/index.html">pudl.transform.ferceqr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../transform/gridpathratoolkit/index.html">pudl.transform.gridpathratoolkit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../transform/nrelatb/index.html">pudl.transform.nrelatb</a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../transform/params/index.html">pudl.transform.params</a><input aria-label="Toggle navigation of pudl.transform.params" class="toctree-checkbox" id="toctree-checkbox-35" name="toctree-checkbox-35" role="switch" type="checkbox"/><label for="toctree-checkbox-35"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../transform/params/ferc1/index.html">pudl.transform.params.ferc1</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../transform/phmsagas/index.html">pudl.transform.phmsagas</a></li>
<li class="toctree-l4"><a class="reference internal" href="../transform/rus/index.html">pudl.transform.rus</a></li>
<li class="toctree-l4"><a class="reference internal" href="../transform/rus12/index.html">pudl.transform.rus12</a></li>
<li class="toctree-l4"><a class="reference internal" href="../transform/rus7/index.html">pudl.transform.rus7</a></li>
<li class="toctree-l4"><a class="reference internal" href="../transform/sec10k/index.html">pudl.transform.sec10k</a></li>
<li class="toctree-l4"><a class="reference internal" href="../transform/vcerare/index.html">pudl.transform.vcerare</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../validate/index.html">pudl.validate</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../workspace/index.html">pudl.workspace</a><input aria-label="Toggle navigation of pudl.workspace" class="toctree-checkbox" id="toctree-checkbox-36" name="toctree-checkbox-36" role="switch" type="checkbox"/><label for="toctree-checkbox-36"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../workspace/datastore/index.html">pudl.workspace.datastore</a></li>
<li class="toctree-l4"><a class="reference internal" href="../workspace/resource_cache/index.html">pudl.workspace.resource_cache</a></li>
<li class="toctree-l4"><a class="reference internal" href="../workspace/setup/index.html">pudl.workspace.setup</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../bibliography.html">Bibliography</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../../../_sources/autoapi/pudl/helpers/index.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="module-pudl.helpers">
<span id="pudl-helpers"></span><h1>pudl.helpers<a class="headerlink" href="#module-pudl.helpers" title="Link to this heading">¶</a></h1>
<p>General utility functions that are used in a variety of contexts.</p>
<p>The functions in this module are used in various stages of the ETL and post-etl
processes. They are usually not dataset specific, but not always. If a function is
designed to be used as a general purpose tool, applicable in multiple scenarios, it
should probably live here. There are lost of transform type functions in here that help
with cleaning and restructuring dataframes.</p>
<section id="attributes">
<h2>Attributes<a class="headerlink" href="#attributes" title="Link to this heading">¶</a></h2>
<div class="table-wrapper autosummary longtable docutils container">
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pudl.helpers.sum_na" title="pudl.helpers.sum_na"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sum_na</span></code></a></p></td>
<td><p>A sum function that returns NA if the Series includes any NA values.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pudl.helpers.logger" title="pudl.helpers.logger"><code class="xref py py-obj docutils literal notranslate"><span class="pre">logger</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Link to this heading">¶</a></h2>
<div class="table-wrapper autosummary longtable docutils container">
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pudl.helpers.TableDiff" title="pudl.helpers.TableDiff"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TableDiff</span></code></a></p></td>
<td><p>Represent a diff between two versions of the same table.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pudl.helpers.ParquetData" title="pudl.helpers.ParquetData"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ParquetData</span></code></a></p></td>
<td><p>Wrap table data offloaded as parquet file(s) on disk.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Link to this heading">¶</a></h2>
<div class="table-wrapper autosummary longtable docutils container">
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pudl.helpers.label_map" title="pudl.helpers.label_map"><code class="xref py py-obj docutils literal notranslate"><span class="pre">label_map</span></code></a>(→ collections.defaultdict[str, ...)</p></td>
<td><p>Build a mapping dictionary from two columns of a labeling / coding dataframe.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pudl.helpers.find_new_ferc1_strings" title="pudl.helpers.find_new_ferc1_strings"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_new_ferc1_strings</span></code></a>(→ set[str])</p></td>
<td><p>Identify as-of-yet uncategorized freeform strings in FERC Form 1.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pudl.helpers.find_foreign_key_errors" title="pudl.helpers.find_foreign_key_errors"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_foreign_key_errors</span></code></a>(→ list[dict[str, Any]])</p></td>
<td><p>Report foreign key violations from a dictionary of dataframes.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pudl.helpers.download_zip_url" title="pudl.helpers.download_zip_url"><code class="xref py py-obj docutils literal notranslate"><span class="pre">download_zip_url</span></code></a>(→ None)</p></td>
<td><p>Download and save a Zipfile locally.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pudl.helpers.add_fips_ids" title="pudl.helpers.add_fips_ids"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_fips_ids</span></code></a>(→ pandas.DataFrame)</p></td>
<td><p>Add State and County FIPS IDs to a dataframe.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pudl.helpers.add_state_id_fips" title="pudl.helpers.add_state_id_fips"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_state_id_fips</span></code></a>(→ pandas.DataFrame)</p></td>
<td><p>Add the State FIPS codes.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pudl.helpers.add_county_fips_id" title="pudl.helpers.add_county_fips_id"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_county_fips_id</span></code></a>(→ pandas.DataFrame)</p></td>
<td><p>Add the County FIPS codes to a table with State FIPS codes.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pudl.helpers.clean_eia_counties" title="pudl.helpers.clean_eia_counties"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clean_eia_counties</span></code></a>(→ pandas.DataFrame)</p></td>
<td><p>Replace non-standard county names with county names from US Census.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pudl.helpers.oob_to_nan" title="pudl.helpers.oob_to_nan"><code class="xref py py-obj docutils literal notranslate"><span class="pre">oob_to_nan</span></code></a>(→ pandas.DataFrame)</p></td>
<td><p>Set non-numeric values and those outside of a given range to NaN.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pudl.helpers.oob_to_nan_with_dependent_cols" title="pudl.helpers.oob_to_nan_with_dependent_cols"><code class="xref py py-obj docutils literal notranslate"><span class="pre">oob_to_nan_with_dependent_cols</span></code></a>(→ pandas.DataFrame)</p></td>
<td><p>Call <a class="reference internal" href="#pudl.helpers.oob_to_nan" title="pudl.helpers.oob_to_nan"><code class="xref py py-func docutils literal notranslate"><span class="pre">oob_to_nan()</span></code></a> and additionally nullify any derived columns.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pudl.helpers.prep_dir" title="pudl.helpers.prep_dir"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prep_dir</span></code></a>(→ pathlib.Path)</p></td>
<td><p>Create (or delete and recreate) a directory.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pudl.helpers.is_doi" title="pudl.helpers.is_doi"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_doi</span></code></a>(→ bool)</p></td>
<td><p>Determine if a string is a valid digital object identifier (DOI).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pudl.helpers.convert_col_to_datetime" title="pudl.helpers.convert_col_to_datetime"><code class="xref py py-obj docutils literal notranslate"><span class="pre">convert_col_to_datetime</span></code></a>(→ pandas.DataFrame)</p></td>
<td><p>Convert a non-datetime column in a dataframe to a datetime64[s].</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pudl.helpers.full_timeseries_date_merge" title="pudl.helpers.full_timeseries_date_merge"><code class="xref py py-obj docutils literal notranslate"><span class="pre">full_timeseries_date_merge</span></code></a>(→ pandas.DataFrame)</p></td>
<td><p>Merge dataframes with different date frequencies and expand to a full timeseries.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pudl.helpers._add_suffix_to_date_on" title="pudl.helpers._add_suffix_to_date_on"><code class="xref py py-obj docutils literal notranslate"><span class="pre">_add_suffix_to_date_on</span></code></a>(date_on)</p></td>
<td><p>Check date_on list is valid and add _temp_for_merge suffix.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pudl.helpers.date_merge" title="pudl.helpers.date_merge"><code class="xref py py-obj docutils literal notranslate"><span class="pre">date_merge</span></code></a>(→ pandas.DataFrame)</p></td>
<td><p>Merge two dataframes that have different report date frequencies.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pudl.helpers.expand_timeseries" title="pudl.helpers.expand_timeseries"><code class="xref py py-obj docutils literal notranslate"><span class="pre">expand_timeseries</span></code></a>(→ pandas.DataFrame)</p></td>
<td><p>Expand a dataframe to a include a full time series at a given frequency.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pudl.helpers.organize_cols" title="pudl.helpers.organize_cols"><code class="xref py py-obj docutils literal notranslate"><span class="pre">organize_cols</span></code></a>(→ pandas.DataFrame)</p></td>
<td><p>Organize columns into key ID &amp; name fields &amp; alphabetical data columns.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pudl.helpers.simplify_strings" title="pudl.helpers.simplify_strings"><code class="xref py py-obj docutils literal notranslate"><span class="pre">simplify_strings</span></code></a>(→ pandas.DataFrame)</p></td>
<td><p>Simplify the strings contained in a set of dataframe columns.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pudl.helpers.cleanstrings_series" title="pudl.helpers.cleanstrings_series"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cleanstrings_series</span></code></a>(→ pandas.Series)</p></td>
<td><p>Clean up the strings in a single column/Series.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pudl.helpers.cleanstrings" title="pudl.helpers.cleanstrings"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cleanstrings</span></code></a>(→ pandas.DataFrame)</p></td>
<td><p>Consolidate freeform strings in several dataframe columns.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pudl.helpers.fix_int_na" title="pudl.helpers.fix_int_na"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fix_int_na</span></code></a>(→ pandas.DataFrame)</p></td>
<td><p>Convert NA containing integer columns from float to string.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pudl.helpers.month_year_to_date" title="pudl.helpers.month_year_to_date"><code class="xref py py-obj docutils literal notranslate"><span class="pre">month_year_to_date</span></code></a>(→ pandas.DataFrame)</p></td>
<td><p>Convert all pairs of year/month fields in a dataframe into Date fields.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pudl.helpers.convert_to_date" title="pudl.helpers.convert_to_date"><code class="xref py py-obj docutils literal notranslate"><span class="pre">convert_to_date</span></code></a>(→ pandas.DataFrame)</p></td>
<td><p>Convert specified year, month or day columns into a datetime object.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pudl.helpers.remove_leading_zeros_from_numeric_strings" title="pudl.helpers.remove_leading_zeros_from_numeric_strings"><code class="xref py py-obj docutils literal notranslate"><span class="pre">remove_leading_zeros_from_numeric_strings</span></code></a>(...)</p></td>
<td><p>Remove leading zeros frame column values that are numeric strings.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pudl.helpers.standardize_na_values" title="pudl.helpers.standardize_na_values"><code class="xref py py-obj docutils literal notranslate"><span class="pre">standardize_na_values</span></code></a>(→ pandas.DataFrame)</p></td>
<td><p>Replace common apparently NA values in numerical columns with the floating point np.nan.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pudl.helpers.simplify_columns" title="pudl.helpers.simplify_columns"><code class="xref py py-obj docutils literal notranslate"><span class="pre">simplify_columns</span></code></a>(→ pandas.DataFrame)</p></td>
<td><p>Simplify column labels for use as snake_case database fields.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pudl.helpers.drop_tables" title="pudl.helpers.drop_tables"><code class="xref py py-obj docutils literal notranslate"><span class="pre">drop_tables</span></code></a>(→ None)</p></td>
<td><p>Drops all tables from a SQLite database.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pudl.helpers.merge_dicts" title="pudl.helpers.merge_dicts"><code class="xref py py-obj docutils literal notranslate"><span class="pre">merge_dicts</span></code></a>(→ dict[Any, Any])</p></td>
<td><p>Merge multiple dictionaries together.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pudl.helpers.convert_cols_dtypes" title="pudl.helpers.convert_cols_dtypes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">convert_cols_dtypes</span></code></a>(→ pandas.DataFrame)</p></td>
<td><p>Convert a PUDL dataframe's columns to the correct data type.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pudl.helpers.generate_rolling_avg" title="pudl.helpers.generate_rolling_avg"><code class="xref py py-obj docutils literal notranslate"><span class="pre">generate_rolling_avg</span></code></a>(→ pandas.DataFrame)</p></td>
<td><p>Generate a rolling average.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pudl.helpers.fillna_w_rolling_avg" title="pudl.helpers.fillna_w_rolling_avg"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fillna_w_rolling_avg</span></code></a>(→ pandas.DataFrame)</p></td>
<td><p>Fill NA values with a rolling average.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pudl.helpers.groupby_agg_label_unique_source_or_mixed" title="pudl.helpers.groupby_agg_label_unique_source_or_mixed"><code class="xref py py-obj docutils literal notranslate"><span class="pre">groupby_agg_label_unique_source_or_mixed</span></code></a>(→ str | None)</p></td>
<td><p>Get either the unique source in a group or return mixed.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pudl.helpers.count_records" title="pudl.helpers.count_records"><code class="xref py py-obj docutils literal notranslate"><span class="pre">count_records</span></code></a>(→ pandas.DataFrame)</p></td>
<td><p>Count the number of unique records in group in a dataframe.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pudl.helpers.cleanstrings_snake" title="pudl.helpers.cleanstrings_snake"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cleanstrings_snake</span></code></a>(→ pandas.DataFrame)</p></td>
<td><p>Clean the strings in a columns in a dataframe with snake case.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pudl.helpers.zero_pad_numeric_string" title="pudl.helpers.zero_pad_numeric_string"><code class="xref py py-obj docutils literal notranslate"><span class="pre">zero_pad_numeric_string</span></code></a>(→ pandas.Series)</p></td>
<td><p>Clean up fixed-width leading zero padded numeric (e.g. ZIP, FIPS) codes.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pudl.helpers.iterate_multivalue_dict" title="pudl.helpers.iterate_multivalue_dict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">iterate_multivalue_dict</span></code></a>(**kwargs)</p></td>
<td><p>Make dicts from dict with main dict key and one value of main dict.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pudl.helpers.dedupe_on_category" title="pudl.helpers.dedupe_on_category"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dedupe_on_category</span></code></a>(→ pandas.DataFrame)</p></td>
<td><p>Deduplicate a df using a sorted category to retain preferred values.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pudl.helpers.dedupe_and_drop_nas" title="pudl.helpers.dedupe_and_drop_nas"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dedupe_and_drop_nas</span></code></a>(→ pandas.DataFrame)</p></td>
<td><p>Deduplicate a df by comparing primary key columns and dropping null rows.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pudl.helpers.drop_records_with_null_in_column" title="pudl.helpers.drop_records_with_null_in_column"><code class="xref py py-obj docutils literal notranslate"><span class="pre">drop_records_with_null_in_column</span></code></a>(→ pandas.DataFrame)</p></td>
<td><p>Drop a prescribed number of records with null values in a column.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pudl.helpers.standardize_percentages_ratio" title="pudl.helpers.standardize_percentages_ratio"><code class="xref py py-obj docutils literal notranslate"><span class="pre">standardize_percentages_ratio</span></code></a>(→ pandas.DataFrame)</p></td>
<td><p>Standardize year-to-year changes in mixed percentage/ratio reporting in a column.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pudl.helpers.calc_capacity_factor" title="pudl.helpers.calc_capacity_factor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_capacity_factor</span></code></a>(→ pandas.DataFrame)</p></td>
<td><p>Calculate capacity factor.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pudl.helpers.weighted_average" title="pudl.helpers.weighted_average"><code class="xref py py-obj docutils literal notranslate"><span class="pre">weighted_average</span></code></a>(→ pandas.DataFrame)</p></td>
<td><p>Generate a weighted average.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pudl.helpers.sum_and_weighted_average_agg" title="pudl.helpers.sum_and_weighted_average_agg"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sum_and_weighted_average_agg</span></code></a>(→ pandas.DataFrame)</p></td>
<td><p>Aggregate dataframe by summing and using weighted averages.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pudl.helpers.get_eia_ferc_acct_map" title="pudl.helpers.get_eia_ferc_acct_map"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_eia_ferc_acct_map</span></code></a>(→ pandas.DataFrame)</p></td>
<td><p>Get map of EIA technology_description/pm codes &lt;&gt; ferc accounts.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pudl.helpers.dedupe_n_flatten_list_of_lists" title="pudl.helpers.dedupe_n_flatten_list_of_lists"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dedupe_n_flatten_list_of_lists</span></code></a>(→ list)</p></td>
<td><p>Flatten a list of lists and remove duplicates.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pudl.helpers.flatten_list" title="pudl.helpers.flatten_list"><code class="xref py py-obj docutils literal notranslate"><span class="pre">flatten_list</span></code></a>(→ collections.abc.Generator)</p></td>
<td><p>Flatten an irregular (arbitrarily nested) list of lists (or sets).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pudl.helpers.convert_df_to_excel_file" title="pudl.helpers.convert_df_to_excel_file"><code class="xref py py-obj docutils literal notranslate"><span class="pre">convert_df_to_excel_file</span></code></a>(→ pandas.ExcelFile)</p></td>
<td><p>Convert a <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> into a <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.ExcelFile.html#pandas.ExcelFile" title="(in pandas v3.0.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.ExcelFile</span></code></a>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pudl.helpers.get_asset_keys" title="pudl.helpers.get_asset_keys"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_asset_keys</span></code></a>(→ set[dagster.AssetKey])</p></td>
<td><p>Get a set of asset keys from a list of asset definitions.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pudl.helpers.get_asset_group_keys" title="pudl.helpers.get_asset_group_keys"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_asset_group_keys</span></code></a>(→ list[str])</p></td>
<td><p>Get a list of asset names in a given asset group.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pudl.helpers.convert_col_to_bool" title="pudl.helpers.convert_col_to_bool"><code class="xref py py-obj docutils literal notranslate"><span class="pre">convert_col_to_bool</span></code></a>(→ pandas.DataFrame)</p></td>
<td><p>Turn a column into a boolean while preserving NA values.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pudl.helpers.fix_boolean_columns" title="pudl.helpers.fix_boolean_columns"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fix_boolean_columns</span></code></a>(→ pandas.DataFrame)</p></td>
<td><p>Fix standard issues with boolean columns.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pudl.helpers.scale_by_ownership" title="pudl.helpers.scale_by_ownership"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scale_by_ownership</span></code></a>(→ pandas.DataFrame)</p></td>
<td><p>Generate proportional data by ownership %s.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pudl.helpers.get_dagster_execution_config" title="pudl.helpers.get_dagster_execution_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_dagster_execution_config</span></code></a>([num_workers, ...])</p></td>
<td><p>Get the dagster execution config for a given number of workers.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pudl.helpers.assert_cols_areclose" title="pudl.helpers.assert_cols_areclose"><code class="xref py py-obj docutils literal notranslate"><span class="pre">assert_cols_areclose</span></code></a>(df, a_cols, b_cols, ...)</p></td>
<td><p>Check if two column sets of a dataframe are close to each other.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pudl.helpers.diff_wide_tables" title="pudl.helpers.diff_wide_tables"><code class="xref py py-obj docutils literal notranslate"><span class="pre">diff_wide_tables</span></code></a>(→ TableDiff)</p></td>
<td><p>Diff values across multiple iterations of the same wide table.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pudl.helpers.retry" title="pudl.helpers.retry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">retry</span></code></a>(func, retry_on[, max_retries, base_delay_sec])</p></td>
<td><p>Retry a function with a short sleep between each try.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pudl.helpers.get_parquet_table_polars" title="pudl.helpers.get_parquet_table_polars"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_parquet_table_polars</span></code></a>(→ polars.LazyFrame)</p></td>
<td><p>Read a table from a parquet file and return as a polars LazyFrame.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pudl.helpers.get_parquet_table" title="pudl.helpers.get_parquet_table"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_parquet_table</span></code></a>(...)</p></td>
<td><p>Read a table from Parquet files with optional column selection and filtering.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pudl.helpers.standardize_phone_column" title="pudl.helpers.standardize_phone_column"><code class="xref py py-obj docutils literal notranslate"><span class="pre">standardize_phone_column</span></code></a>(→ pandas.DataFrame)</p></td>
<td><p>Standardize phone numbers in the specified columns of the DataFrame.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pudl.helpers.persist_table_as_parquet" title="pudl.helpers.persist_table_as_parquet"><code class="xref py py-obj docutils literal notranslate"><span class="pre">persist_table_as_parquet</span></code></a>(→ ParquetData)</p></td>
<td><p>Write data from DataFrame or LazyFrame to disk as a parquet file.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pudl.helpers.lf_from_parquet" title="pudl.helpers.lf_from_parquet"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lf_from_parquet</span></code></a>(→ polars.LazyFrame)</p></td>
<td><p>Scan parquet file(s) from disk and return Polars LazyFrame.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pudl.helpers.df_from_parquet" title="pudl.helpers.df_from_parquet"><code class="xref py py-obj docutils literal notranslate"><span class="pre">df_from_parquet</span></code></a>(→ pandas.DataFrame)</p></td>
<td><p>Read data from a set of parquet files and return a pandas DataFrame.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pudl.helpers.duckdb_relation_from_parquet" title="pudl.helpers.duckdb_relation_from_parquet"><code class="xref py py-obj docutils literal notranslate"><span class="pre">duckdb_relation_from_parquet</span></code></a>(...)</p></td>
<td><p>Create a duckdb relation to read from parquet files.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pudl.helpers.duckdb_extract_zipped_csv" title="pudl.helpers.duckdb_extract_zipped_csv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">duckdb_extract_zipped_csv</span></code></a>() → tuple[str, ParquetData])</p></td>
<td><p>Extract data from zipped CSV page(s) in a data archive.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Link to this heading">¶</a></h2>
<dl class="py data">
<dt class="sig sig-object py" id="pudl.helpers.sum_na">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">sum_na</span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#sum_na"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.sum_na" title="Link to this definition">¶</a></dt>
<dd><p>A sum function that returns NA if the Series includes any NA values.</p>
<p>In many of our aggregations we need to override the default behavior of treating NA
values as if they were zero. E.g. when calculating the heat rates of generation units,
if there are some months where fuel consumption is reported as NA, but electricity
generation is reported normally, then the fuel consumption for the year needs to be NA,
otherwise we’ll get unrealistic heat rates.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pudl.helpers.logger">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">logger</span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#logger"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.logger" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.label_map">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">label_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">from_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'code'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'label'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">null_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas._libs.missing.NAType</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">pd.NA</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/collections.html#collections.defaultdict" title="(in Python v3.14)"><span class="pre">collections.defaultdict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas._libs.missing.NAType</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#label_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.label_map" title="Link to this definition">¶</a></dt>
<dd><p>Build a mapping dictionary from two columns of a labeling / coding dataframe.</p>
<p>These dataframes document the meanings of the codes that show up in much of the
originally reported data. They’re defined in <a class="reference internal" href="../metadata/codes/index.html#module-pudl.metadata.codes" title="pudl.metadata.codes"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pudl.metadata.codes</span></code></a>.  This
function is mostly used to build maps that can translate the hard to understand
short codes into longer human-readable codes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – The coding / labeling dataframe. Must contain columns <code class="docutils literal notranslate"><span class="pre">from_col</span></code>
and <code class="docutils literal notranslate"><span class="pre">to_col</span></code>.</p></li>
<li><p><strong>from_col</strong> – Label of column containing the existing codes to be replaced.</p></li>
<li><p><strong>to_col</strong> – Label of column containing the new codes to be swapped in.</p></li>
<li><p><strong>null_value</strong> – Default (Null) value to map to when a value which doesn’t
appear in <code class="docutils literal notranslate"><span class="pre">from_col</span></code> is encountered.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A mapping dictionary suitable for use with <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.map.html#pandas.Series.map" title="(in pandas v3.0.1)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.map()</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.find_new_ferc1_strings">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">find_new_ferc1_strings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">field</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">strdict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ferc1_engine</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">sqlalchemy.Engine</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.14)"><span class="pre">set</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#find_new_ferc1_strings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.find_new_ferc1_strings" title="Link to this definition">¶</a></dt>
<dd><p>Identify as-of-yet uncategorized freeform strings in FERC Form 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>table</strong> – Name of the FERC Form 1 DB to search.</p></li>
<li><p><strong>field</strong> – Name of the column in that table to search.</p></li>
<li><p><strong>strdict</strong> – A string cleaning dictionary. See
e.g. <code class="xref py py-const docutils literal notranslate"><span class="pre">pudl.transform.ferc1.FUEL_UNIT_STRINGS</span></code></p></li>
<li><p><strong>ferc1_engine</strong> – SQL Alchemy DB connection engine for the FERC Form 1 DB.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Any string found in the searched table + field that was not part of any of
categories enumerated in strdict.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.find_foreign_key_errors">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">find_foreign_key_errors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dfs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#find_foreign_key_errors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.find_foreign_key_errors" title="Link to this definition">¶</a></dt>
<dd><p>Report foreign key violations from a dictionary of dataframes.</p>
<p>The database schema to check against is generated based on the names of the
dataframes (keys of the dictionary) and the PUDL metadata structures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dfs</strong> – Keys are table names, and values are dataframes ready for loading
into the SQLite database.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of dictionaries, each one pertains to a single database table
in which a foreign key constraint violation was found, and it includes
the table name, foreign key definition, and the elements of the
dataframe that violated the foreign key constraint.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.download_zip_url">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">download_zip_url</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">url</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.14)"><span class="pre">pathlib.Path</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunk_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">9.05</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#download_zip_url"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.download_zip_url" title="Link to this definition">¶</a></dt>
<dd><p>Download and save a Zipfile locally.</p>
<p>Useful for acquiring and storing non-PUDL data locally.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>url</strong> – The URL from which to download the Zipfile</p></li>
<li><p><strong>save_path</strong> – The location to save the file.</p></li>
<li><p><strong>chunk_size</strong> – Data chunk in bytes to use while downloading.</p></li>
<li><p><strong>timeout</strong> – Time to wait for the server to accept a connection.
See <a class="reference external" href="https://requests.readthedocs.io/en/latest/user/advanced/#timeouts">https://requests.readthedocs.io/en/latest/user/advanced/#timeouts</a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.add_fips_ids">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">add_fips_ids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">geocodes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'state'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">county_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'county'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#add_fips_ids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.add_fips_ids" title="Link to this definition">¶</a></dt>
<dd><p>Add State and County FIPS IDs to a dataframe.</p>
<p>To just add State FIPS IDs, make county_col = None.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.add_state_id_fips">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">add_state_id_fips</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">geocodes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#add_state_id_fips"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.add_state_id_fips" title="Link to this definition">¶</a></dt>
<dd><p>Add the State FIPS codes.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.add_county_fips_id">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">add_county_fips_id</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">geocodes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">county_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#add_county_fips_id"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.add_county_fips_id" title="Link to this definition">¶</a></dt>
<dd><p>Add the County FIPS codes to a table with State FIPS codes.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.clean_eia_counties">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">clean_eia_counties</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'state'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">county_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'county'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#clean_eia_counties"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.clean_eia_counties" title="Link to this definition">¶</a></dt>
<dd><p>Replace non-standard county names with county names from US Census.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.oob_to_nan">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">oob_to_nan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lb</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ub</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#oob_to_nan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.oob_to_nan" title="Link to this definition">¶</a></dt>
<dd><p>Set non-numeric values and those outside of a given range to NaN.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – The dataframe containing values to be altered.</p></li>
<li><p><strong>cols</strong> – Labels of the columns whose values are to be changed.</p></li>
<li><p><strong>lb</strong> – Lower bound, below which values are set to NaN. If None, don’t use a lower
bound.</p></li>
<li><p><strong>ub</strong> – Upper bound, below which values are set to NaN. If None, don’t use an upper
bound.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The altered DataFrame.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.oob_to_nan_with_dependent_cols">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">oob_to_nan_with_dependent_cols</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dependent_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lb</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ub</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#oob_to_nan_with_dependent_cols"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.oob_to_nan_with_dependent_cols" title="Link to this definition">¶</a></dt>
<dd><p>Call <a class="reference internal" href="#pudl.helpers.oob_to_nan" title="pudl.helpers.oob_to_nan"><code class="xref py py-func docutils literal notranslate"><span class="pre">oob_to_nan()</span></code></a> and additionally nullify any derived columns.</p>
<p>Set values in <code class="docutils literal notranslate"><span class="pre">cols</span></code> to NaN if values are non-numeric or outside of a
given range. The corresponding values in <code class="docutils literal notranslate"><span class="pre">dependent_cols</span></code> are then set
to NaN. <code class="docutils literal notranslate"><span class="pre">dependent_cols</span></code> should be columns derived from one or multiple
of the columns in <code class="docutils literal notranslate"><span class="pre">cols</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – The dataframe containing values to be altered.</p></li>
<li><p><strong>cols</strong> – Labels of the columns whose values are to be changed.</p></li>
<li><p><strong>dependent_cols</strong> – Labels of the columns whose corresponding values should also be
nullified. Columns are derived from one or multiple of the columns in
<code class="docutils literal notranslate"><span class="pre">cols</span></code>.</p></li>
<li><p><strong>lb</strong> – Lower bound, below which values are set to NaN. If None, don’t use a lower
bound.</p></li>
<li><p><strong>ub</strong> – Upper bound, below which values are set to NaN. If None, don’t use an upper
bound.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The altered DataFrame.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.prep_dir">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">prep_dir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.14)"><span class="pre">pathlib.Path</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">clobber</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.14)"><span class="pre">pathlib.Path</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#prep_dir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.prep_dir" title="Link to this definition">¶</a></dt>
<dd><p>Create (or delete and recreate) a directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dir_path</strong> – path to the directory that you are trying to clean and prepare.</p></li>
<li><p><strong>clobber</strong> – If True and dir_path exists, it will be removed and replaced with a
new, empty directory.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#FileExistsError" title="(in Python v3.14)"><strong>FileExistsError</strong></a> – if a file or directory already exists at dir_path.</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Path to the created directory.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.is_doi">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">is_doi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">doi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#is_doi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.is_doi" title="Link to this definition">¶</a></dt>
<dd><p>Determine if a string is a valid digital object identifier (DOI).</p>
<p>Function simply checks whether the offered string matches a regular
expression – it doesn’t check whether the DOI is actually registered
with the relevant authority.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>doi</strong> – String to validate.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if doi matches the regex for valid DOIs, False otherwise.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.convert_col_to_datetime">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">convert_col_to_datetime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">date_col_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#convert_col_to_datetime"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.convert_col_to_datetime" title="Link to this definition">¶</a></dt>
<dd><p>Convert a non-datetime column in a dataframe to a datetime64[s].</p>
<p>If the column isn’t a datetime, it needs to be converted to a string type
first so that integer years are formatted correctly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – Dataframe with column to convert.</p></li>
<li><p><strong>date_col_name</strong> – name of the datetime column to convert.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataframe with the converted datetime column.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.full_timeseries_date_merge">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">full_timeseries_date_merge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">left</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">right</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">on</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left_date_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'report_date'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_date_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'report_date'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_date_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'report_date'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date_on</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">['year']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">how</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'inner'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'outer'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'left'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'right'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'cross'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'inner'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">report_at_start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'MS'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#full_timeseries_date_merge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.full_timeseries_date_merge" title="Link to this definition">¶</a></dt>
<dd><p>Merge dataframes with different date frequencies and expand to a full timeseries.</p>
<p>Arguments: see arguments for <code class="docutils literal notranslate"><span class="pre">date_merge</span></code> and <code class="docutils literal notranslate"><span class="pre">expand_timeseries</span></code></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers._add_suffix_to_date_on">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">_add_suffix_to_date_on</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date_on</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pudl/helpers.html#_add_suffix_to_date_on"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers._add_suffix_to_date_on" title="Link to this definition">¶</a></dt>
<dd><p>Check date_on list is valid and add _temp_for_merge suffix.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.date_merge">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">date_merge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">left</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">right</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">on</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left_date_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'report_date'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_date_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'report_date'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_date_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'report_date'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date_on</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">how</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'inner'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'outer'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'left'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'right'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'cross'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'inner'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">report_at_start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#date_merge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.date_merge" title="Link to this definition">¶</a></dt>
<dd><p>Merge two dataframes that have different report date frequencies.</p>
<p>We often need to bring together data that is reported at different
temporal granularities e.g. monthly basis versus annual basis. This function
acts as a wrapper on a pandas merge to allow merging at different temporal
granularities. The date columns of both dataframes are separated into
year, quarter, month, and day columns. Then, the dataframes are merged according
to <code class="docutils literal notranslate"><span class="pre">how</span></code> on the columns specified by the <code class="docutils literal notranslate"><span class="pre">on</span></code> and <code class="docutils literal notranslate"><span class="pre">date_on</span></code> argument,
which list the new temporal columns to merge on as well any additional shared columns.
Finally, the datetime column is reconstructed in the output dataframe and
named according to the <code class="docutils literal notranslate"><span class="pre">new_date_col</span></code> parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>left</strong> – The left dataframe in the merge. Typically monthly in our use
cases if doing a left merge E.g. <code class="docutils literal notranslate"><span class="pre">core_eia923__monthly_generation</span></code>.
Must contain columns specified by <code class="docutils literal notranslate"><span class="pre">left_date_col</span></code> and
<code class="docutils literal notranslate"><span class="pre">on</span></code> argument.</p></li>
<li><p><strong>right</strong> – The right dataframe in the merge. Typically annual in our uses
cases if doing a left merge E.g. <code class="docutils literal notranslate"><span class="pre">core_eia860__scd_generators</span></code>.
Must contain columns specified by <code class="docutils literal notranslate"><span class="pre">right_date_col</span></code> and
<code class="docutils literal notranslate"><span class="pre">on</span></code> argument.</p></li>
<li><p><strong>on</strong> – The columns to merge on that are shared between both
dataframes. Typically ID columns like <code class="docutils literal notranslate"><span class="pre">plant_id_eia</span></code>, <code class="docutils literal notranslate"><span class="pre">generator_id</span></code>
or <code class="docutils literal notranslate"><span class="pre">boiler_id</span></code>.</p></li>
<li><p><strong>left_date_col</strong> – Column in <code class="docutils literal notranslate"><span class="pre">left</span></code> containing datetime like data. Default is
<code class="docutils literal notranslate"><span class="pre">report_date</span></code>. Must be a Datetime or convertible to a Datetime using
<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.to_datetime.html#pandas.to_datetime" title="(in pandas v3.0.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">pandas.to_datetime()</span></code></a></p></li>
<li><p><strong>right_date_col</strong> – Column in <code class="docutils literal notranslate"><span class="pre">right</span></code> containing datetime like data. Default is
<code class="docutils literal notranslate"><span class="pre">report_date</span></code>. Must be a Datetime or convertible to a Datetime using
<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.to_datetime.html#pandas.to_datetime" title="(in pandas v3.0.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">pandas.to_datetime()</span></code></a>.</p></li>
<li><p><strong>new_date_col</strong> – Name of the reconstructed datetime column in the output dataframe.</p></li>
<li><p><strong>date_on</strong> – The temporal columns to merge on. Values in this list
of columns must be [<code class="docutils literal notranslate"><span class="pre">year</span></code>, <code class="docutils literal notranslate"><span class="pre">quarter</span></code>, <code class="docutils literal notranslate"><span class="pre">month</span></code>, <code class="docutils literal notranslate"><span class="pre">day</span></code>].
E.g. if a monthly reported dataframe is being merged onto a daily reported
dataframe, then the merge would be performed on <code class="docutils literal notranslate"><span class="pre">[&quot;year&quot;,</span> <span class="pre">&quot;month&quot;]</span></code>.
If one of these temporal columns already exists in the dataframe it will not
be clobbered by the merge, as the suffix “_temp_for_merge” is added when
expanding the datetime column into year, quarter, month, and day. By default,
<code class="docutils literal notranslate"><span class="pre">date_on</span></code> will just include year.</p></li>
<li><p><strong>how</strong> – How the dataframes should be merged. See <code class="xref py py-func docutils literal notranslate"><span class="pre">pandas.DataFrame.merge()</span></code>.</p></li>
<li><p><strong>report_at_start</strong> – Whether the data in the dataframe whose report date is not being
kept in the merged output (in most cases the less frequently reported dataframe)
is reported at the start or end of the time period e.g. January 1st
for annual data.</p></li>
<li><p><strong>kwargs</strong> – Additional arguments to pass to <code class="xref py py-func docutils literal notranslate"><span class="pre">pandas.DataFrame.merge()</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Merged contents of left and right input dataframes.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – if <code class="docutils literal notranslate"><span class="pre">left_date_col</span></code> or <code class="docutils literal notranslate"><span class="pre">right_date_col</span></code> columns are missing from their
respective input dataframes.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – if any of the labels referenced in <code class="docutils literal notranslate"><span class="pre">on</span></code> are missing from either
the left or right dataframes.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.expand_timeseries">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">expand_timeseries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'report_date'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'MS'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_through_freq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'year'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'month'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'day'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'year'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#expand_timeseries"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.expand_timeseries" title="Link to this definition">¶</a></dt>
<dd><p>Expand a dataframe to a include a full time series at a given frequency.</p>
<p>This function adds a full timeseries to the given dataframe for each group
of columns specified by <code class="docutils literal notranslate"><span class="pre">key_cols</span></code>. The data in the timeseries will be filled
with the next previous chronological observation for a group of primary key columns
specified by <code class="docutils literal notranslate"><span class="pre">key_cols</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – The dataframe to expand. Must have <code class="docutils literal notranslate"><span class="pre">date_col</span></code> in columns.</p></li>
<li><p><strong>key_cols</strong> – Column names of the non-date primary key columns in the dataframe.
The resulting dataframe will have a full timeseries expanded for each
unique group of these ID columns that are present in the dataframe.</p></li>
<li><p><strong>date_col</strong> – Name of the datetime column being expanded into a full timeseries.</p></li>
<li><p><strong>freq</strong> – The frequency of the time series to expand the data to.
See <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#timeseries-offset-aliases" title="(in pandas v3.0.1)"><span class="xref std std-ref">here</span></a> for a list of
frequency aliases.</p></li>
<li><p><strong>fill_through_freq</strong> – The frequency in which to fill in the data through. For
example, if equal to “year” the data will be filled in through the end of
the last reported year for each grouping of <code class="docutils literal notranslate"><span class="pre">key_cols</span></code>. Valid frequencies
are only “year”, “month”, or “day”.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – if <code class="docutils literal notranslate"><span class="pre">fill_through_freq</span></code> is not one of “year”, “month” or “day”.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.organize_cols">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">organize_cols</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#organize_cols"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.organize_cols" title="Link to this definition">¶</a></dt>
<dd><p>Organize columns into key ID &amp; name fields &amp; alphabetical data columns.</p>
<p>For readability, it’s nice to group a few key columns at the beginning
of the dataframe (e.g. report_year or report_date, plant_id…) and then
put all the rest of the data columns in alphabetical order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – The DataFrame to be re-organized.</p></li>
<li><p><strong>cols</strong> – The columns to put first, in their desired output ordering.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dataframe with the same columns as the input
DataFrame df, but with cols first, in the same order as they
were passed in, and the remaining columns sorted alphabetically.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)">pandas.DataFrame</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.simplify_strings">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">simplify_strings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#simplify_strings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.simplify_strings" title="Link to this definition">¶</a></dt>
<dd><p>Simplify the strings contained in a set of dataframe columns.</p>
<p>Performs several operations to simplify strings for comparison and parsing purposes.
These include removing Unicode control characters, stripping leading and trailing
whitespace, using lowercase characters, and compacting all internal whitespace to a
single space.</p>
<p>Leaves null values unaltered. Casts other values with astype(str).</p>
<p>Running with <code class="docutils literal notranslate"><span class="pre">copy=False</span></code> is intended for memory-intensive data frames where no
upstream process retains a reference to the data. Use care with this option,
and keep an eye out for spooky data changes showing up in unexpected places.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – DataFrame whose columns are being cleaned up.</p></li>
<li><p><strong>columns</strong> – The labels of the string columns to be simplified.</p></li>
<li><p><strong>copy</strong> – (Default True) Return a copy, making no changes to the original data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The whole DataFrame that was passed in, with the string columns cleaned up.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.cleanstrings_series">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">cleanstrings_series</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v3.0.1)"><span class="pre">pandas.Series</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">str_map</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unmapped</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simplify</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v3.0.1)"><span class="pre">pandas.Series</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#cleanstrings_series"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.cleanstrings_series" title="Link to this definition">¶</a></dt>
<dd><p>Clean up the strings in a single column/Series.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>col</strong> – A pandas Series, typically a single column of a
dataframe, containing the freeform strings that are to be cleaned.</p></li>
<li><p><strong>str_map</strong> – A dictionary of lists of strings, in which the keys are
the simplified canonical strings, with which each string found in
the corresponding list will be replaced.</p></li>
<li><p><strong>unmapped</strong> – A value with which to replace any string found in col
that is not found in one of the lists of strings in map. Typically
the null string ‘’. If None, these strings will not be replaced.</p></li>
<li><p><strong>simplify</strong> – If True, strip and compact whitespace, and lowercase
all strings in both the list of values to be replaced, and the
values found in col. This can reduce the number of strings that
need to be kept track of.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The cleaned up Series / column, suitable for replacing the original messy column
in a <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.cleanstrings">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">cleanstrings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stringmaps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unmapped</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simplify</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#cleanstrings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.cleanstrings" title="Link to this definition">¶</a></dt>
<dd><p>Consolidate freeform strings in several dataframe columns.</p>
<p>This function will consolidate freeform strings found in <code class="docutils literal notranslate"><span class="pre">columns</span></code> into simplified
categories, as defined by <code class="docutils literal notranslate"><span class="pre">stringmaps</span></code>. This is useful when a field contains many
different strings that are really meant to represent a finite number of categories,
e.g. a type of fuel. It can also be used to create simplified categories that apply
to similar attributes that are reported in various data sources from different
agencies that use their own taxonomies.</p>
<p>The function takes and returns a pandas.DataFrame, making it suitable for use with
the <code class="xref py py-func docutils literal notranslate"><span class="pre">pandas.DataFrame.pipe()</span></code> method in a chain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – the DataFrame containing the string columns to be cleaned up.</p></li>
<li><p><strong>columns</strong> – a list of string column labels found in the column index of df. These
are the columns that will be cleaned.</p></li>
<li><p><strong>stringmaps</strong> – a list of dictionaries. The keys of these dictionaries are strings,
and the values are lists of strings. Each dictionary in the list corresponds
to a column in columns. The keys of the dictionaries are the values with
which every string in the list of values will be replaced.</p></li>
<li><p><strong>unmapped</strong> – the value with which strings not found in the stringmap dictionary
will be replaced. Typically the null string ‘’. If None, then strings found
in the columns but not in the stringmap will be left unchanged.</p></li>
<li><p><strong>simplify</strong> – If true, strip whitespace, remove duplicate whitespace, and force
lower-case on both the string map and the values found in the columns to be
cleaned. This can reduce the overall number of string values that need to be
tracked.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The function returns a new DataFrame containing the cleaned strings.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.fix_int_na">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">fix_int_na</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float_na</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">np.nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int_na</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">str_na</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#fix_int_na"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.fix_int_na" title="Link to this definition">¶</a></dt>
<dd><p>Convert NA containing integer columns from float to string.</p>
<p>Numpy doesn’t have a real NA value for integers. When pandas stores integer data
which has NA values, it thus upcasts integers to floating point values, using np.nan
values for NA. However, in order to dump some of our dataframes to CSV files for use
in data packages, we need to write out integer formatted numbers, with empty strings
as the NA value. This function replaces np.nan values with a sentinel value,
converts the column to integers, and then to strings, finally replacing the sentinel
value with the desired NA string.</p>
<p>This is an interim solution – now that pandas extension arrays have been
implemented, we need to go back through and convert all of these integer columns
that contain NA values to Nullable Integer types like Int64.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – The dataframe to be fixed. This argument allows method chaining with the
pipe() method.</p></li>
<li><p><strong>columns</strong> – A list of DataFrame column labels indicating which columns need to be
reformatted for output.</p></li>
<li><p><strong>float_na</strong> – The floating point value to be interpreted as NA and replaced in col.</p></li>
<li><p><strong>int_na</strong> – Sentinel value to substitute for float_na prior to conversion of the
column to integers.</p></li>
<li><p><strong>str_na</strong> – String value to substitute for int_na after the column has been
converted to strings.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new DataFrame, with the selected columns converted to strings that look like
integers, compatible with the postgresql COPY FROM command.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.month_year_to_date">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">month_year_to_date</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#month_year_to_date"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.month_year_to_date" title="Link to this definition">¶</a></dt>
<dd><p>Convert all pairs of year/month fields in a dataframe into Date fields.</p>
<p>This function finds all column names within a dataframe that match the
regular expression ‘_month$’ and ‘_year$’, and looks for pairs that have
identical prefixes before the underscore. These fields are assumed to
describe a date, accurate to the month.  The two fields are used to
construct a new _date column (having the same prefix) and the month/year
columns are then dropped.</p>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>This function needs to be combined with convert_to_date, and improved:
* find and use a _day$ column as well
* allow specification of default month &amp; day values, if none are found.
* allow specification of lists of year, month, and day columns to be
combined, rather than automataically finding all the matching ones.
* Do the Right Thing when invalid or NA values are encountered.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fields.</strong> (<em>The DataFrame in which to convert year/months fields to Date</em>)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A DataFrame in which the year/month fields have been converted into Date fields.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.convert_to_date">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">convert_to_date</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">date_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'report_date'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'report_year'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">month_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'report_month'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">day_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'report_day'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">month_na_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">day_na_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#convert_to_date"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.convert_to_date" title="Link to this definition">¶</a></dt>
<dd><p>Convert specified year, month or day columns into a datetime object.</p>
<p>If the input <code class="docutils literal notranslate"><span class="pre">date_col</span></code> already exists in the input dataframe, then no
conversion is applied, and the original dataframe is returned unchanged.
Otherwise the constructed date is placed in that column, and the columns
which were used to create the date are dropped.</p>
<p>Running with <code class="docutils literal notranslate"><span class="pre">copy=False</span></code> is intended for memory-intensive data frames where no
upstream process retains a reference to the data. Use care with this option,
and keep an eye out for spooky data changes showing up in unexpected places.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – dataframe to convert</p></li>
<li><p><strong>date_col</strong> – the name of the column you want in the output.</p></li>
<li><p><strong>year_col</strong> – the name of the year column in the original table.</p></li>
<li><p><strong>month_col</strong> – the name of the month column in the original table.</p></li>
<li><p><strong>day_col</strong> – the name of the day column in the original table.</p></li>
<li><p><strong>month_na_value</strong> – generated month if no month exists or if the month
value is NA.</p></li>
<li><p><strong>day_na_value</strong> – generated day if no day exists or if the day value is NA.</p></li>
<li><p><strong>copy</strong> – (default True) return a copy, making no changes to the original data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A DataFrame in which the year, month, day columns values have been converted
into datetime objects.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.remove_leading_zeros_from_numeric_strings">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">remove_leading_zeros_from_numeric_strings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#remove_leading_zeros_from_numeric_strings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.remove_leading_zeros_from_numeric_strings" title="Link to this definition">¶</a></dt>
<dd><p>Remove leading zeros frame column values that are numeric strings.</p>
<p>Sometimes an ID column (like generator_id or unit_id) will be reported with leading
zeros and sometimes it won’t. For example, in the Excel spreadsheets published by
EIA, the same generator may show up with the ID “0001” and “1” in different years
This function strips the leading zeros from those numeric strings so the data can
be mapped across years and datasets more reliably.</p>
<p>Alphanumeric generator IDs with leadings zeroes are not affected, as we found no
instances in which an alphanumeric ID appeared both with and without leading zeroes.
The ID “0A1” will stay “0A1”.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – A DataFrame containing the column you’d like to remove numeric leading zeros
from.</p></li>
<li><p><strong>col_name</strong> – The name of the column you’d like to remove numeric leading zeros
from.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A DataFrame without leading zeros for numeric string values in the desired
column.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.standardize_na_values">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">standardize_na_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#standardize_na_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.standardize_na_values" title="Link to this definition">¶</a></dt>
<dd><p>Replace common apparently NA values in numerical columns with the floating point np.nan.</p>
<p>Currently replaces the empty string, any string entirely composed of whitespace,
bare decimal points, and any string entirely composed of hyphens, all of which are
common stand-ins for NA in spreadsheets. Note that this function should only be
applied to columns whose true type is expected to be numeric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> – The DataFrame to clean.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame with regularized NA values.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.simplify_columns">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">simplify_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#simplify_columns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.simplify_columns" title="Link to this definition">¶</a></dt>
<dd><p>Simplify column labels for use as snake_case database fields.</p>
<p>All column labels will be simplified by:</p>
<ul class="simple">
<li><p>Replacing all non-alphanumeric characters with spaces.</p></li>
<li><p>Forcing all letters to be lower case.</p></li>
<li><p>Compacting internal whitespace to a single “ “.</p></li>
<li><p>Stripping leading and trailing whitespace.</p></li>
<li><p>Replacing all remaining whitespace with underscores.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> – The DataFrame whose column labels to simplify.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dataframe with simplified column names.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.drop_tables">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">drop_tables</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">engine</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">sqlalchemy.Engine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clobber</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#drop_tables"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.drop_tables" title="Link to this definition">¶</a></dt>
<dd><p>Drops all tables from a SQLite database.</p>
<p>Creates an sa.schema.MetaData object reflecting the structure of the
database that the passed in <code class="docutils literal notranslate"><span class="pre">engine</span></code> refers to, and uses that schema to
drop all existing tables.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>engine</strong> – An SQL Alchemy SQLite database Engine pointing at an existing SQLite
database to be deleted.</p></li>
<li><p><strong>clobber</strong> – Whether or not to allow a non-empty DB to be removed.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#AssertionError" title="(in Python v3.14)"><strong>AssertionError</strong></a> – if clobber is False and there are any tables in the database.</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.merge_dicts">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">merge_dicts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lods</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#merge_dicts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.merge_dicts" title="Link to this definition">¶</a></dt>
<dd><p>Merge multiple dictionaries together.</p>
<p>Given any number of dicts, shallow copy and merge into a new dict, precedence goes
to key value pairs in latter dicts within the input list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>lods</strong> – a list of dictionaries.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A single merged dictionary.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.convert_cols_dtypes">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">convert_cols_dtypes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#convert_cols_dtypes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.convert_cols_dtypes" title="Link to this definition">¶</a></dt>
<dd><p>Convert a PUDL dataframe’s columns to the correct data type.</p>
<p>Boolean type conversions created a special problem, because null values in
boolean columns get converted to True (which is bonkers!)… we generally
want to preserve the null values and definitely don’t want them to be True,
so we are keeping those columns as objects and preforming a simple mask for
the boolean columns.</p>
<p>The other exception in here is with the <code class="docutils literal notranslate"><span class="pre">utility_id_eia</span></code> column. It is
often an object column of strings. All of the strings are numbers, so it
should be possible to convert to <code class="xref py py-func docutils literal notranslate"><span class="pre">pandas.Int32Dtype()</span></code> directly, but it
is requiring us to convert to int first. There will probably be other
columns that have this problem… and hopefully pandas just enables this
direct conversion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – dataframe with columns that appear in the PUDL tables.</p></li>
<li><p><strong>data_source</strong> – the name of the datasource (eia, ferc1, etc.)</p></li>
<li><p><strong>name</strong> – name of the table (for logging only!)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Input dataframe, but with column types as specified by
<a class="reference internal" href="../metadata/fields/index.html#pudl.metadata.fields.FIELD_METADATA" title="pudl.metadata.fields.FIELD_METADATA"><code class="xref py py-const docutils literal notranslate"><span class="pre">pudl.metadata.fields.FIELD_METADATA</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.generate_rolling_avg">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">generate_rolling_avg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#generate_rolling_avg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.generate_rolling_avg" title="Link to this definition">¶</a></dt>
<dd><p>Generate a rolling average.</p>
<p>For a given dataframe with a <code class="docutils literal notranslate"><span class="pre">report_date</span></code> column, generate a monthly
rolling average and use this rolling average to impute missing values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – Original dataframe. Must have group_cols column, a data_col column and a
<code class="docutils literal notranslate"><span class="pre">report_date</span></code> column.</p></li>
<li><p><strong>group_cols</strong> – a list of columns to groupby.</p></li>
<li><p><strong>data_col</strong> – the name of the data column.</p></li>
<li><p><strong>window</strong> – rolling window argument to pass to <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.rolling.html#pandas.Series.rolling" title="(in pandas v3.0.1)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.rolling()</span></code></a>.</p></li>
<li><p><strong>kwargs</strong> – Additional arguments to pass to <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.rolling.html#pandas.Series.rolling" title="(in pandas v3.0.1)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.rolling()</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame with an additional rolling average column.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.fillna_w_rolling_avg">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">fillna_w_rolling_avg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_og</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#fillna_w_rolling_avg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.fillna_w_rolling_avg" title="Link to this definition">¶</a></dt>
<dd><p>Fill NA values with a rolling average.</p>
<p>Imputes null values from a dataframe using a rolling monthly average.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_og</strong> – Original dataframe. Must have <code class="docutils literal notranslate"><span class="pre">group_cols</span></code> columns, a <code class="docutils literal notranslate"><span class="pre">data_col</span></code>
column and a <code class="docutils literal notranslate"><span class="pre">report_date</span></code> column.</p></li>
<li><p><strong>group_cols</strong> – a list of columns to groupby.</p></li>
<li><p><strong>data_col</strong> – the name of the data column we’re trying to fill.</p></li>
<li><p><strong>window</strong> – rolling window to pass to <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.rolling.html#pandas.Series.rolling" title="(in pandas v3.0.1)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.rolling()</span></code></a>.</p></li>
<li><p><strong>kwargs</strong> – Additional arguments to pass to <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.rolling.html#pandas.Series.rolling" title="(in pandas v3.0.1)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.Series.rolling()</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dataframe with nulls filled in.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)">pandas.DataFrame</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.groupby_agg_label_unique_source_or_mixed">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">groupby_agg_label_unique_source_or_mixed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v3.0.1)"><span class="pre">pandas.Series</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#groupby_agg_label_unique_source_or_mixed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.groupby_agg_label_unique_source_or_mixed" title="Link to this definition">¶</a></dt>
<dd><p>Get either the unique source in a group or return mixed.</p>
<p>Custom function for groupby.agg. Written specifically for
aggregating records with fuel_cost_per_mmbtu_source.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.count_records">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">count_records</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_count_col_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#count_records"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.count_records" title="Link to this definition">¶</a></dt>
<dd><p>Count the number of unique records in group in a dataframe.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – dataframe you would like to groupby and count.</p></li>
<li><p><strong>cols</strong> – list of columns to group and count by.</p></li>
<li><p><strong>new_count_col_name</strong> – the name that will be assigned to the column that will
contain the count.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame containing only <code class="docutils literal notranslate"><span class="pre">cols</span></code> and <code class="docutils literal notranslate"><span class="pre">new_count_col_name</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.cleanstrings_snake">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">cleanstrings_snake</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#cleanstrings_snake"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.cleanstrings_snake" title="Link to this definition">¶</a></dt>
<dd><p>Clean the strings in a columns in a dataframe with snake case.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – original dataframe.</p></li>
<li><p><strong>cols</strong> – list of columns in to apply snake case to.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.zero_pad_numeric_string">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">zero_pad_numeric_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v3.0.1)"><span class="pre">pandas.Series</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_digits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v3.0.1)"><span class="pre">pandas.Series</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#zero_pad_numeric_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.zero_pad_numeric_string" title="Link to this definition">¶</a></dt>
<dd><p>Clean up fixed-width leading zero padded numeric (e.g. ZIP, FIPS) codes.</p>
<p>Often values like ZIP and FIPS codes are stored as integers, or get
converted to floating point numbers because there are NA values in the
column. Sometimes other non-digit strings are included like Canadian
postal codes mixed in with ZIP codes, or IMP (imported) instead of a
FIPS county code. This function attempts to manage these irregularities
and produce either fixed-width leading zero padded strings of digits
having a specified length (n_digits) or NA.</p>
<ul class="simple">
<li><p>Convert the Series to a nullable string.</p></li>
<li><p>Remove any decimal point and all digits following it.</p></li>
<li><p>Remove any non-digit characters.</p></li>
<li><p>Replace any empty strings with NA.</p></li>
<li><p>Replace any strings longer than n_digits with NA.</p></li>
<li><p>Pad remaining digit-only strings to n_digits length.</p></li>
<li><p>Replace (invalid) all-zero codes with NA.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>col</strong> – The Series to clean. May be numeric, string, object, etc.</p></li>
<li><p><strong>n_digits</strong> – the desired length of the output strings.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A Series of nullable strings, containing only all-numeric strings
having length n_digits, padded with leading zeroes if necessary.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.iterate_multivalue_dict">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">iterate_multivalue_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pudl/helpers.html#iterate_multivalue_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.iterate_multivalue_dict" title="Link to this definition">¶</a></dt>
<dd><p>Make dicts from dict with main dict key and one value of main dict.</p>
<dl class="simple">
<dt>If kwargs is {‘form;: ‘gas_distribution’, ‘years’: [2019, 2020]}, it will yield these results:</dt><dd><p>{‘form’: ‘gas_distribution’, ‘years’: 2019}
{‘form’: ‘gas_distribution’, ‘years’: 2020}</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.dedupe_on_category">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">dedupe_on_category</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dedup_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">category_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sorter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#dedupe_on_category"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.dedupe_on_category" title="Link to this definition">¶</a></dt>
<dd><p>Deduplicate a df using a sorted category to retain preferred values.</p>
<p>Use a sorted category column to retain your preferred values when a
dataframe is deduplicated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dedup_df</strong> – the dataframe with the records to deduplicate.</p></li>
<li><p><strong>base_cols</strong> – list of columns which must not be duplicated.</p></li>
<li><p><strong>category_name</strong> – name of the categorical column to order values for deduplication.</p></li>
<li><p><strong>sorter</strong> – sorted list of categorical values found in the <code class="docutils literal notranslate"><span class="pre">category_name</span></code> column.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The deduplicated dataframe.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.dedupe_and_drop_nas">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">dedupe_and_drop_nas</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dedup_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">primary_key_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#dedupe_and_drop_nas"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.dedupe_and_drop_nas" title="Link to this definition">¶</a></dt>
<dd><p>Deduplicate a df by comparing primary key columns and dropping null rows.</p>
<p>When a primary key appears twice in a dataframe, and one record is all null other
than the primary keys, drop the null row.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dedup_df</strong> – the dataframe with the records to deduplicate.</p></li>
<li><p><strong>primary_key_cols</strong> – list of columns which must not be duplicated.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The deduplicated dataframe.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.drop_records_with_null_in_column">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">drop_records_with_null_in_column</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">column</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_of_expected_nulls</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#drop_records_with_null_in_column"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.drop_records_with_null_in_column" title="Link to this definition">¶</a></dt>
<dd><p>Drop a prescribed number of records with null values in a column.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – table with column to check.</p></li>
<li><p><strong>column</strong> – name of column with potential null values.</p></li>
<li><p><strong>num_of_expected_nulls</strong> – the number of records with null values in the column</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#AssertionError" title="(in Python v3.14)"><strong>AssertionError</strong></a> – If there are more nulls in the df then the
num_of_expected_nulls.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.standardize_percentages_ratio">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">standardize_percentages_ratio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frac_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">mixed_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">years_to_standardize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#standardize_percentages_ratio"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.standardize_percentages_ratio" title="Link to this definition">¶</a></dt>
<dd><p>Standardize year-to-year changes in mixed percentage/ratio reporting in a column.</p>
<p>When a column uses both 0-1 and 0-100 scales to describe percentages, standardize
the years using 0-100 scales to 0-1 ratios/fractions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frac_df</strong> – the dataframe with the columns to standardize.</p></li>
<li><p><strong>mixed_cols</strong> – list of columns which should get standardized to the 0-1 scale.</p></li>
<li><p><strong>years_to_standardize</strong> – range of dates over which the standardization should occur.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The standardized dataframe.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.calc_capacity_factor">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">calc_capacity_factor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'YS'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'MS'</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_cap_fact</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_cap_fact</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#calc_capacity_factor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.calc_capacity_factor" title="Link to this definition">¶</a></dt>
<dd><p>Calculate capacity factor.</p>
<p>Capacity factor is calculated from the capacity, the net generation over a
time period and the hours in that same time period. The dates from that
dataframe are pulled out to determine the hours in each period based on
the frequency. The number of hours is used in calculating the capacity
factor. Then records with capacity factors outside the range specified by
<code class="docutils literal notranslate"><span class="pre">min_cap_fact</span></code> and <code class="docutils literal notranslate"><span class="pre">max_cap_fact</span></code> are dropped.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – table with required inputs for capacity factor (<code class="docutils literal notranslate"><span class="pre">report_date</span></code>,
<code class="docutils literal notranslate"><span class="pre">net_generation_mwh</span></code> and <code class="docutils literal notranslate"><span class="pre">capacity_mw</span></code>).</p></li>
<li><p><strong>freq</strong> – String describing time frequency at which to aggregate the reported data,
such as <code class="docutils literal notranslate"><span class="pre">MS</span></code> (month start) or <code class="docutils literal notranslate"><span class="pre">YS</span></code> (annual start).</p></li>
<li><p><strong>min_cap_fact</strong> – Lower bound, below which values are set to NaN. If None, don’t use
a lower bound. Default is None.</p></li>
<li><p><strong>max_cap_fact</strong> – Upper bound, below which values are set to NaN.  If None, don’t
use an upper bound. Default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Modified version of the input DataFrame with an additional <code class="docutils literal notranslate"><span class="pre">capacity_factor</span></code>
column.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.weighted_average">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">weighted_average</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#weighted_average"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.weighted_average" title="Link to this definition">¶</a></dt>
<dd><p>Generate a weighted average.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – A DataFrame containing, at minimum, the columns specified in the other
parameters data_col and weight_col.</p></li>
<li><p><strong>data_col</strong> – column name of data column to average</p></li>
<li><p><strong>weight_col</strong> – column name to weight on</p></li>
<li><p><strong>by</strong> – List of columns to group by when calculating the weighted average value.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A table with <code class="docutils literal notranslate"><span class="pre">by</span></code> columns as the index and the weighted <code class="docutils literal notranslate"><span class="pre">data_col</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.sum_and_weighted_average_agg">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">sum_and_weighted_average_agg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sum_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wtavg_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#sum_and_weighted_average_agg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.sum_and_weighted_average_agg" title="Link to this definition">¶</a></dt>
<dd><p>Aggregate dataframe by summing and using weighted averages.</p>
<p>Many times we want to aggregate a data table using the same groupby columns but with
different aggregation methods. This function combines two of our most common
aggregation methods (summing and applying a weighted average) into one function.
Because pandas does not have a built-in weighted average method for groupby we use
:func:<code class="docutils literal notranslate"><span class="pre">weighted_average</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_in</strong> – input table to aggregate. Must have columns in <code class="docutils literal notranslate"><span class="pre">id_cols</span></code>, <code class="docutils literal notranslate"><span class="pre">sum_cols</span></code>
and keys from <code class="docutils literal notranslate"><span class="pre">wtavg_dict</span></code>.</p></li>
<li><p><strong>by</strong> – columns to group/aggregate based on. These columns will be passed as an
argument into grouby as <code class="docutils literal notranslate"><span class="pre">by</span></code> arg.</p></li>
<li><p><strong>sum_cols</strong> – columns to sum.</p></li>
<li><p><strong>wtavg_dict</strong> – dictionary of columns to average (keys) and columns to weight by
(values).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>table with join of columns from <code class="docutils literal notranslate"><span class="pre">by</span></code>, <code class="docutils literal notranslate"><span class="pre">sum_cols</span></code> and keys of <code class="docutils literal notranslate"><span class="pre">wtavg_dict</span></code>.
Primary key of table will be <code class="docutils literal notranslate"><span class="pre">by</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.get_eia_ferc_acct_map">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">get_eia_ferc_acct_map</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#get_eia_ferc_acct_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.get_eia_ferc_acct_map" title="Link to this definition">¶</a></dt>
<dd><p>Get map of EIA technology_description/pm codes &lt;&gt; ferc accounts.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>table which maps the combination of EIA’s technology</dt><dd><p>description and prime mover code to FERC Uniform System of Accounts
(USOA) accounting names. Read more about USOA
<a class="reference external" href="https://www.ferc.gov/enforcement-legal/enforcement/accounting-matters">here</a>
The output table has the following columns: <code class="docutils literal notranslate"><span class="pre">['technology_description',</span>
<span class="pre">'prime_mover_code',</span> <span class="pre">'ferc_acct_name']</span></code></p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)">pandas.DataFrame</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.dedupe_n_flatten_list_of_lists">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">dedupe_n_flatten_list_of_lists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mega_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#dedupe_n_flatten_list_of_lists"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.dedupe_n_flatten_list_of_lists" title="Link to this definition">¶</a></dt>
<dd><p>Flatten a list of lists and remove duplicates.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.flatten_list">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">flatten_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterable" title="(in Python v3.14)"><span class="pre">collections.abc.Iterable</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Generator" title="(in Python v3.14)"><span class="pre">collections.abc.Generator</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#flatten_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.flatten_list" title="Link to this definition">¶</a></dt>
<dd><p>Flatten an irregular (arbitrarily nested) list of lists (or sets).</p>
<p>Inspiration from
<a class="reference external" href="https://stackoverflow.com/questions/2158395/flatten-an-irregular-arbitrarily-nested-list-of-lists">here</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.convert_df_to_excel_file">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">convert_df_to_excel_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.ExcelFile.html#pandas.ExcelFile" title="(in pandas v3.0.1)"><span class="pre">pandas.ExcelFile</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#convert_df_to_excel_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.convert_df_to_excel_file" title="Link to this definition">¶</a></dt>
<dd><p>Convert a <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></a> into a <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.ExcelFile.html#pandas.ExcelFile" title="(in pandas v3.0.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pandas.ExcelFile</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – The DataFrame to convert.</p></li>
<li><p><strong>kwargs</strong> – Additional arguments to pass into <code class="xref py py-meth docutils literal notranslate"><span class="pre">pandas.to_excel()</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The contents of the input DataFrame, represented as an ExcelFile.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.get_asset_keys">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">get_asset_keys</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">assets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.dagster.io/sections/api/dagster/assets/#dagster.AssetsDefinition" title="(in Dagster)"><span class="pre">dagster.AssetsDefinition</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_asset_specs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.14)"><span class="pre">set</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.dagster.io/sections/api/dagster/assets/#dagster.AssetKey" title="(in Dagster)"><span class="pre">dagster.AssetKey</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#get_asset_keys"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.get_asset_keys" title="Link to this definition">¶</a></dt>
<dd><p>Get a set of asset keys from a list of asset definitions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>assets</strong> – list of asset definitions.</p></li>
<li><p><strong>exclude_asset_specs</strong> – exclude AssetSpecs in the returned list.
Some selection operations don’t allow AssetSpec keys.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A set of asset keys.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.get_asset_group_keys">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">get_asset_group_keys</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">asset_group</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_assets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.dagster.io/sections/api/dagster/assets/#dagster.AssetsDefinition" title="(in Dagster)"><span class="pre">dagster.AssetsDefinition</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#get_asset_group_keys"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.get_asset_group_keys" title="Link to this definition">¶</a></dt>
<dd><p>Get a list of asset names in a given asset group.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>asset_group</strong> – the name of the asset group.</p></li>
<li><p><strong>all_assets</strong> – the collection of assets to select the group from.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of asset names in the asset_group.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.convert_col_to_bool">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">convert_col_to_bool</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">true_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">false_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#convert_col_to_bool"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.convert_col_to_bool" title="Link to this definition">¶</a></dt>
<dd><p>Turn a column into a boolean while preserving NA values.</p>
<p>You don’t have to specify NA as true or false - it will preserve it’s NA-ness unless
you add it to one of the input true/false lists.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – The dataframe containing the column you want to change.</p></li>
<li><p><strong>col_name</strong> – The name of the column you want to turn into a boolean (must be an
existing column, not a new column name).</p></li>
<li><p><strong>true_values</strong> – The list of values in col_name that you want to be marked as True.</p></li>
<li><p><strong>false_values</strong> – The list of values appearing in col_name that you want to be
False.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#AssertionError" title="(in Python v3.14)"><strong>AssertionError</strong></a> – if there are non-NA values in col_name that aren’t specified in
true_values or false_values.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#AssertionError" title="(in Python v3.14)"><strong>AssertionError</strong></a> – if there are values that appear in both true_values and
false_values.</p></li>
</ul>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The original dataframe with col_name as a boolean column.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.fix_boolean_columns">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">fix_boolean_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">boolean_columns_to_fix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#fix_boolean_columns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.fix_boolean_columns" title="Link to this definition">¶</a></dt>
<dd><p>Fix standard issues with boolean columns.</p>
<p>Most boolean columns have either “Y” for True or “N” for False. A subset of the
columns have “X” values which represents a False value. A subset of the columns
have “U” values, presumably for “Unknown,” which must be set to null in order to
convert the columns to datatype Boolean. Other data sources may use a 1/0 system
instead, with 1 as True and 0 as False.</p>
<p>If running with <code class="docutils literal notranslate"><span class="pre">inplace=True</span></code>, will run in-place versions of the fill and
replace operations instead of returning a copy of the data frame. This mode is
useful for memory-intensive data frames, but be aware that upstream processes
retaining a reference to the data will see the changes made here.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.scale_by_ownership">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">scale_by_ownership</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gens</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">own_eia860</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">validate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'1:m'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#scale_by_ownership"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.scale_by_ownership" title="Link to this definition">¶</a></dt>
<dd><p>Generate proportional data by ownership %s.</p>
<p>Why do we have to do this at all? Sometimes generators are owned by
many different utility owners that own slices of that generator. EIA
reports which portion of each generator is owned by which utility
relatively clearly in their ownership table. On the other hand, in
FERC1, sometimes a partial owner reports the full plant-part, sometimes
they report only their ownership portion of the plant-part. And of
course it is not labeled in FERC1. Because of this, we need to compile
all of the possible ownership slices of the EIA generators.</p>
<p>In order to accumulate every possible version of how a generator could
be reported, this method generates two records for each generator’s
reported owners: one of the portion of the plant part they own and one
for the plant-part as a whole. The portion records are labeled in the
<code class="docutils literal notranslate"><span class="pre">ownership_record_type</span></code> column as “owned” and the total records are labeled as
“total”.</p>
<p>In this function we merge in the ownership table so that generators
with multiple owners then have one record per owner with the
ownership fraction (in column <code class="docutils literal notranslate"><span class="pre">fraction_owned</span></code>). Because the ownership
table only contains records for generators that have multiple owners,
we assume that all other generators are owned 100% by their operator.
Then we generate the “total” records by duplicating the “owned” records
but assigning the <code class="docutils literal notranslate"><span class="pre">fraction_owned</span></code> to be 1 (i.e. 100%).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gens</strong> – table with records at the generator level and generator attributes
to be scaled by ownership, must have columns <code class="docutils literal notranslate"><span class="pre">plant_id_eia</span></code>,
<code class="docutils literal notranslate"><span class="pre">generator_id</span></code>, and <code class="docutils literal notranslate"><span class="pre">report_date</span></code></p></li>
<li><p><strong>own_eia860</strong> – the <code class="docutils literal notranslate"><span class="pre">core_eia860__scd_ownership</span></code> table</p></li>
<li><p><strong>scale_cols</strong> – a list of columns in the generator table to slice by ownership
fraction</p></li>
<li><p><strong>validate</strong> – how to validate merging the ownership table onto the
generators table</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Table of generator records with <code class="docutils literal notranslate"><span class="pre">scale_cols</span></code> sliced by ownership fraction
such that there is a “total” and “owned” record for each generator owner.
The “owned” records have the generator’s data scaled to the ownership
percentage (e.g. if a 200 MW generator has a 75% stake owner and a 25%
stake owner, this will result in two “owned” records with 150 MW and 50 MW).
The “total” records correspond to the full plant for every owner (e.g. using
the same 2-owner 200 MW generator as above, each owner will have a
records with 200 MW).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.get_dagster_execution_config">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">get_dagster_execution_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tag_concurrency_limits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pudl/helpers.html#get_dagster_execution_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.get_dagster_execution_config" title="Link to this definition">¶</a></dt>
<dd><p>Get the dagster execution config for a given number of workers.</p>
<p>If num_workers is 0, then the dagster execution config will not include
any limits. With num_workers set to 1, we will use in-process serial
executor, otherwise multi-process executor with maximum of num_workers
will be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_workers</strong> – The number of workers to use for the dagster execution config.
If 0, then the dagster execution config will not include a multiprocess
executor.</p></li>
<li><p><strong>tag_concurrency_limits</strong> – <p>A set of limits that are applied to steps with
particular tags. This is helpful for applying concurrency limits to
highly concurrent and memory intensive portions of the ETL like CEMS.</p>
<p>Dagster description: If a value is set, the limit is applied to
only that key-value pair. If no value is set, the limit is applied
across all values of that key. If the value is set to a dict with
<code class="docutils literal notranslate"><span class="pre">applyLimitPerUniqueValue:</span> <span class="pre">true</span></code>, the limit will apply to the
number of unique values for that key. Note that these limits are
per run, not global.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dagster execution config.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.assert_cols_areclose">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">assert_cols_areclose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mismatch_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">message</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pudl/helpers.html#assert_cols_areclose"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.assert_cols_areclose" title="Link to this definition">¶</a></dt>
<dd><p>Check if two column sets of a dataframe are close to each other.</p>
<p>Ignores NANs and raises if there are too many mismatches.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pudl.helpers.TableDiff">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">TableDiff</span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#TableDiff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.TableDiff" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-obj docutils literal notranslate"><span class="pre">NamedTuple</span></code></p>
<p>Represent a diff between two versions of the same table.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pudl.helpers.TableDiff.deleted">
<span class="sig-name descname"><span class="pre">deleted</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#TableDiff.deleted"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.TableDiff.deleted" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pudl.helpers.TableDiff.added">
<span class="sig-name descname"><span class="pre">added</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#TableDiff.added"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.TableDiff.added" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pudl.helpers.TableDiff.changed">
<span class="sig-name descname"><span class="pre">changed</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#TableDiff.changed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.TableDiff.changed" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pudl.helpers.TableDiff.old_df">
<span class="sig-name descname"><span class="pre">old_df</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#TableDiff.old_df"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.TableDiff.old_df" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pudl.helpers.TableDiff.new_df">
<span class="sig-name descname"><span class="pre">new_df</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#TableDiff.new_df"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.TableDiff.new_df" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.diff_wide_tables">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">diff_wide_tables</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">primary_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Iterable" title="(in Python v3.14)"><span class="pre">collections.abc.Iterable</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">old</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">new</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#pudl.helpers.TableDiff" title="pudl.helpers.TableDiff"><span class="pre">TableDiff</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#diff_wide_tables"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.diff_wide_tables" title="Link to this definition">¶</a></dt>
<dd><p>Diff values across multiple iterations of the same wide table.</p>
<p>We often have tables with many value columns; a straightforward comparison of two
versions of the same table will show you that two rows are different, but
won’t show which of the many values changed.</p>
<p>So we melt the table based on some sort of primary key columns then diff
the old and new values.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.retry">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">retry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.14)"><span class="pre">collections.abc.Callable</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">retry_on</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../metadata/classes/index.html#pudl.metadata.classes.Field.type" title="pudl.metadata.classes.Field.type"><span class="pre">type</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#BaseException" title="(in Python v3.14)"><span class="pre">BaseException</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Ellipsis</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_retries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_delay_sec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pudl/helpers.html#retry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.retry" title="Link to this definition">¶</a></dt>
<dd><p>Retry a function with a short sleep between each try.</p>
<p>Sleeps twice as long before each retry as the last one, e.g. 1/2/4/8/16
seconds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> – the function to retry</p></li>
<li><p><strong>retry_on</strong> – the errors to catch.</p></li>
<li><p><strong>base_delay_sec</strong> – how much time to sleep for the first retry.</p></li>
<li><p><strong>kwargs</strong> – keyword arguments to pass to the wrapped function. Pass non-kwargs as
kwargs too.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.get_parquet_table_polars">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">get_parquet_table_polars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">polars.LazyFrame</span></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#get_parquet_table_polars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.get_parquet_table_polars" title="Link to this definition">¶</a></dt>
<dd><p>Read a table from a parquet file and return as a polars LazyFrame.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.get_parquet_table">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">get_parquet_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://geopandas.org/en/stable/docs/reference/api/geopandas.GeoDataFrame.html#geopandas.GeoDataFrame" title="(in GeoPandas v1.1.2)"><span class="pre">geopandas.GeoDataFrame</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#get_parquet_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.get_parquet_table" title="Link to this definition">¶</a></dt>
<dd><p>Read a table from Parquet files with optional column selection and filtering.</p>
<p>This function provides a general-purpose interface for reading PUDL tables from
Parquet files. It supports selective column reading for performance, optional
filters for data subsetting, and automatic schema validation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>table_name</strong> – Name of the table to read.</p></li>
<li><p><strong>columns</strong> – List of columns to read. If None, all columns are read.</p></li>
<li><p><strong>filters</strong> – Optional filters to apply when reading the Parquet file. See the
<a class="reference external" href="https://arrow.apache.org/docs/python/generated/pyarrow.parquet.read_table.html#pyarrow.parquet.read_table" title="(in Apache Arrow v23.0.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">pyarrow.parquet.read_table()</span></code></a> documentation for details on filter
syntax. If None, no filters are applied.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame with the requested data, with PUDL schema validation applied.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#FileNotFoundError" title="(in Python v3.14)"><strong>FileNotFoundError</strong></a> – If the Parquet file for the table doesn’t exist.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If the table_name is not a valid PUDL resource.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.standardize_phone_column">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">standardize_phone_column</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#standardize_phone_column"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.standardize_phone_column" title="Link to this definition">¶</a></dt>
<dd><p>Standardize phone numbers in the specified columns of the DataFrame.</p>
<p>US numbers: ###-###-####
International numbers with the international code at the beginning.
Numbers with extensions will be appended with “x#”.
Non-numeric entries will be returned as np.nan. Entries with fewer than
10 digits will be returned with no hyphens.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – The DataFrame to modify.</p></li>
<li><p><strong>columns</strong> – A list of the names of the columns that need to be standardized.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The modified DataFrame with standardized phone numbers in the same column.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pudl.helpers.ParquetData">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">ParquetData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">/</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/pudl/helpers.html#ParquetData"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.ParquetData" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.pydantic.dev/latest/api/base_model/#pydantic.BaseModel" title="(in Pydantic Validation v0.0.0)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pydantic.BaseModel</span></code></a></p>
<p>Wrap table data offloaded as parquet file(s) on disk.</p>
<p>Writing data to disk as parquet files enables the use of highly efficient
processing/transforms with tools like Polars or duckdb. This class provides
helpers for managing paths to parquet data on disk.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pudl.helpers.ParquetData.table_name">
<span class="sig-name descname"><span class="pre">table_name</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#ParquetData.table_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.ParquetData.table_name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pudl.helpers.ParquetData.partitions">
<span class="sig-name descname"><span class="pre">partitions</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#ParquetData.partitions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.ParquetData.partitions" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pudl.helpers.ParquetData.parquet_directory">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">parquet_directory</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.14)"><span class="pre">pathlib.Path</span></a></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#ParquetData.parquet_directory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.ParquetData.parquet_directory" title="Link to this definition">¶</a></dt>
<dd><p>Get path to directory for writing/reading parquet files.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pudl.helpers.ParquetData.parquet_path">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">parquet_path</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.14)"><span class="pre">pathlib.Path</span></a></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#ParquetData.parquet_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.ParquetData.parquet_path" title="Link to this definition">¶</a></dt>
<dd><p>Get name of an individual parquet file corresponding to a single partition of data.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.persist_table_as_parquet">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">persist_table_as_parquet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">polars.LazyFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">duckdb.DuckDBPyRelation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">partitions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compression</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'zstd'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'snappy'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'gzip'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'brotli'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'zstd'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#pudl.helpers.ParquetData" title="pudl.helpers.ParquetData"><span class="pre">ParquetData</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#persist_table_as_parquet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.persist_table_as_parquet" title="Link to this definition">¶</a></dt>
<dd><p>Write data from DataFrame or LazyFrame to disk as a parquet file.</p>
<p>Offloading data to disk allows Polars and duckdb to perform highly efficient
transforms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>table_data</strong> – Data to write to disk as either a Pandas DataFrame, Polars LazyFrame, or duckdb relation.</p></li>
<li><p><strong>table_name</strong> – Table name used to construct path to/name of parquet file.</p></li>
<li><p><strong>partitions</strong> – Partitions which correspond to the table_data. If passed
<code class="docutils literal notranslate"><span class="pre">{'years':</span> <span class="pre">1995}</span></code> then this method will produce a parquet file at the path
<code class="docutils literal notranslate"><span class="pre">PudlPaths().parquet_path()</span> <span class="pre">/</span> <span class="pre">table_name</span> <span class="pre">/</span> <span class="pre">'1995.parquet'</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.lf_from_parquet">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">lf_from_parquet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parquet_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#pudl.helpers.ParquetData" title="pudl.helpers.ParquetData"><span class="pre">ParquetData</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_all_partitions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">polars.LazyFrame</span></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#lf_from_parquet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.lf_from_parquet" title="Link to this definition">¶</a></dt>
<dd><p>Scan parquet file(s) from disk and return Polars LazyFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parquet_data</strong> – Points to parquet data on disk.</p></li>
<li><p><strong>use_all_partitions</strong> – If true read the entire directory of parquet files.
Otherwise only read data from the partition specified in parquet_data.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.df_from_parquet">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">df_from_parquet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parquet_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#pudl.helpers.ParquetData" title="pudl.helpers.ParquetData"><span class="pre">ParquetData</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_all_partitions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v3.0.1)"><span class="pre">pandas.DataFrame</span></a></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#df_from_parquet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.df_from_parquet" title="Link to this definition">¶</a></dt>
<dd><p>Read data from a set of parquet files and return a pandas DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parquet_data</strong> – Points to parquet data on disk.</p></li>
<li><p><strong>use_all_partitions</strong> – If true read the entire directory of parquet files.
Otherwise only read data from the partition specified in parquet_data.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.duckdb_relation_from_parquet">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">duckdb_relation_from_parquet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parquet_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#pudl.helpers.ParquetData" title="pudl.helpers.ParquetData"><span class="pre">ParquetData</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_all_partitions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">duckdb.DuckDBPyRelation</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">duckdb.DuckDBPyConnection</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#duckdb_relation_from_parquet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.duckdb_relation_from_parquet" title="Link to this definition">¶</a></dt>
<dd><p>Create a duckdb relation to read from parquet files.</p>
<p>This method is intended to be used as a context manager to keep the duckdb
connection open while the relation is in use.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parquet_data</strong> – Points to parquet data on disk.</p></li>
<li><p><strong>use_all_partitions</strong> – If true read the entire directory of parquet files.
Otherwise only read data from the partition specified in parquet_data.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pudl.helpers.duckdb_extract_zipped_csv">
<span class="sig-prename descclassname"><span class="pre">pudl.helpers.</span></span><span class="sig-name descname"><span class="pre">duckdb_extract_zipped_csv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">partitions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pages</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datasore</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zip_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.14)"><span class="pre">pathlib.Path</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">Path()</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#pudl.helpers.ParquetData" title="pudl.helpers.ParquetData"><span class="pre">ParquetData</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../../../_modules/pudl/helpers.html#duckdb_extract_zipped_csv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pudl.helpers.duckdb_extract_zipped_csv" title="Link to this definition">¶</a></dt>
<dd><p>Extract data from zipped CSV page(s) in a data archive.</p>
<p>A common pattern for raw PUDL data is a set of zipfiles with one zipfile per
partition, and one or more CSV files within each zipfile. This function provides
a highly efficient way to extract data from archives that conform to this pattern
using duckdb. This function is a generator, which will yield a duckdb relation for
each CSV file within a zipfile, allowing the caller to perform transforms using
the relation before writing to disk with the <code class="docutils literal notranslate"><span class="pre">offload_table</span></code> function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> – Name of dataset (required to get archive from datastore).</p></li>
<li><p><strong>partition</strong> – Partitions of resource to extract data from.</p></li>
<li><p><strong>pages</strong> – List of csv files to extract from archive.</p></li>
<li><p><strong>datastore</strong> – Instance of PUDL datastore to get raw data.</p></li>
<li><p><strong>zip_path</strong> – Base path within zipfile that points to where CSV files are stored.
If not explicitly set, assume CSV files are at the top level of the zipfile.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../io_managers/index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">pudl.io_managers</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../glue/ferc714/index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">pudl.glue.ferc714</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2016-2026, Catalyst Cooperative, CC-BY-4.0
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">pudl.helpers</a><ul>
<li><a class="reference internal" href="#attributes">Attributes</a></li>
<li><a class="reference internal" href="#classes">Classes</a></li>
<li><a class="reference internal" href="#functions">Functions</a></li>
<li><a class="reference internal" href="#module-contents">Module Contents</a><ul>
<li><a class="reference internal" href="#pudl.helpers.sum_na"><code class="docutils literal notranslate"><span class="pre">sum_na</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.logger"><code class="docutils literal notranslate"><span class="pre">logger</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.label_map"><code class="docutils literal notranslate"><span class="pre">label_map()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.find_new_ferc1_strings"><code class="docutils literal notranslate"><span class="pre">find_new_ferc1_strings()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.find_foreign_key_errors"><code class="docutils literal notranslate"><span class="pre">find_foreign_key_errors()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.download_zip_url"><code class="docutils literal notranslate"><span class="pre">download_zip_url()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.add_fips_ids"><code class="docutils literal notranslate"><span class="pre">add_fips_ids()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.add_state_id_fips"><code class="docutils literal notranslate"><span class="pre">add_state_id_fips()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.add_county_fips_id"><code class="docutils literal notranslate"><span class="pre">add_county_fips_id()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.clean_eia_counties"><code class="docutils literal notranslate"><span class="pre">clean_eia_counties()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.oob_to_nan"><code class="docutils literal notranslate"><span class="pre">oob_to_nan()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.oob_to_nan_with_dependent_cols"><code class="docutils literal notranslate"><span class="pre">oob_to_nan_with_dependent_cols()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.prep_dir"><code class="docutils literal notranslate"><span class="pre">prep_dir()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.is_doi"><code class="docutils literal notranslate"><span class="pre">is_doi()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.convert_col_to_datetime"><code class="docutils literal notranslate"><span class="pre">convert_col_to_datetime()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.full_timeseries_date_merge"><code class="docutils literal notranslate"><span class="pre">full_timeseries_date_merge()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers._add_suffix_to_date_on"><code class="docutils literal notranslate"><span class="pre">_add_suffix_to_date_on()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.date_merge"><code class="docutils literal notranslate"><span class="pre">date_merge()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.expand_timeseries"><code class="docutils literal notranslate"><span class="pre">expand_timeseries()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.organize_cols"><code class="docutils literal notranslate"><span class="pre">organize_cols()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.simplify_strings"><code class="docutils literal notranslate"><span class="pre">simplify_strings()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.cleanstrings_series"><code class="docutils literal notranslate"><span class="pre">cleanstrings_series()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.cleanstrings"><code class="docutils literal notranslate"><span class="pre">cleanstrings()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.fix_int_na"><code class="docutils literal notranslate"><span class="pre">fix_int_na()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.month_year_to_date"><code class="docutils literal notranslate"><span class="pre">month_year_to_date()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.convert_to_date"><code class="docutils literal notranslate"><span class="pre">convert_to_date()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.remove_leading_zeros_from_numeric_strings"><code class="docutils literal notranslate"><span class="pre">remove_leading_zeros_from_numeric_strings()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.standardize_na_values"><code class="docutils literal notranslate"><span class="pre">standardize_na_values()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.simplify_columns"><code class="docutils literal notranslate"><span class="pre">simplify_columns()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.drop_tables"><code class="docutils literal notranslate"><span class="pre">drop_tables()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.merge_dicts"><code class="docutils literal notranslate"><span class="pre">merge_dicts()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.convert_cols_dtypes"><code class="docutils literal notranslate"><span class="pre">convert_cols_dtypes()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.generate_rolling_avg"><code class="docutils literal notranslate"><span class="pre">generate_rolling_avg()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.fillna_w_rolling_avg"><code class="docutils literal notranslate"><span class="pre">fillna_w_rolling_avg()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.groupby_agg_label_unique_source_or_mixed"><code class="docutils literal notranslate"><span class="pre">groupby_agg_label_unique_source_or_mixed()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.count_records"><code class="docutils literal notranslate"><span class="pre">count_records()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.cleanstrings_snake"><code class="docutils literal notranslate"><span class="pre">cleanstrings_snake()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.zero_pad_numeric_string"><code class="docutils literal notranslate"><span class="pre">zero_pad_numeric_string()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.iterate_multivalue_dict"><code class="docutils literal notranslate"><span class="pre">iterate_multivalue_dict()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.dedupe_on_category"><code class="docutils literal notranslate"><span class="pre">dedupe_on_category()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.dedupe_and_drop_nas"><code class="docutils literal notranslate"><span class="pre">dedupe_and_drop_nas()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.drop_records_with_null_in_column"><code class="docutils literal notranslate"><span class="pre">drop_records_with_null_in_column()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.standardize_percentages_ratio"><code class="docutils literal notranslate"><span class="pre">standardize_percentages_ratio()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.calc_capacity_factor"><code class="docutils literal notranslate"><span class="pre">calc_capacity_factor()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.weighted_average"><code class="docutils literal notranslate"><span class="pre">weighted_average()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.sum_and_weighted_average_agg"><code class="docutils literal notranslate"><span class="pre">sum_and_weighted_average_agg()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.get_eia_ferc_acct_map"><code class="docutils literal notranslate"><span class="pre">get_eia_ferc_acct_map()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.dedupe_n_flatten_list_of_lists"><code class="docutils literal notranslate"><span class="pre">dedupe_n_flatten_list_of_lists()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.flatten_list"><code class="docutils literal notranslate"><span class="pre">flatten_list()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.convert_df_to_excel_file"><code class="docutils literal notranslate"><span class="pre">convert_df_to_excel_file()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.get_asset_keys"><code class="docutils literal notranslate"><span class="pre">get_asset_keys()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.get_asset_group_keys"><code class="docutils literal notranslate"><span class="pre">get_asset_group_keys()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.convert_col_to_bool"><code class="docutils literal notranslate"><span class="pre">convert_col_to_bool()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.fix_boolean_columns"><code class="docutils literal notranslate"><span class="pre">fix_boolean_columns()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.scale_by_ownership"><code class="docutils literal notranslate"><span class="pre">scale_by_ownership()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.get_dagster_execution_config"><code class="docutils literal notranslate"><span class="pre">get_dagster_execution_config()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.assert_cols_areclose"><code class="docutils literal notranslate"><span class="pre">assert_cols_areclose()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.TableDiff"><code class="docutils literal notranslate"><span class="pre">TableDiff</span></code></a><ul>
<li><a class="reference internal" href="#pudl.helpers.TableDiff.deleted"><code class="docutils literal notranslate"><span class="pre">TableDiff.deleted</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.TableDiff.added"><code class="docutils literal notranslate"><span class="pre">TableDiff.added</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.TableDiff.changed"><code class="docutils literal notranslate"><span class="pre">TableDiff.changed</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.TableDiff.old_df"><code class="docutils literal notranslate"><span class="pre">TableDiff.old_df</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.TableDiff.new_df"><code class="docutils literal notranslate"><span class="pre">TableDiff.new_df</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pudl.helpers.diff_wide_tables"><code class="docutils literal notranslate"><span class="pre">diff_wide_tables()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.retry"><code class="docutils literal notranslate"><span class="pre">retry()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.get_parquet_table_polars"><code class="docutils literal notranslate"><span class="pre">get_parquet_table_polars()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.get_parquet_table"><code class="docutils literal notranslate"><span class="pre">get_parquet_table()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.standardize_phone_column"><code class="docutils literal notranslate"><span class="pre">standardize_phone_column()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.ParquetData"><code class="docutils literal notranslate"><span class="pre">ParquetData</span></code></a><ul>
<li><a class="reference internal" href="#pudl.helpers.ParquetData.table_name"><code class="docutils literal notranslate"><span class="pre">ParquetData.table_name</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.ParquetData.partitions"><code class="docutils literal notranslate"><span class="pre">ParquetData.partitions</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.ParquetData.parquet_directory"><code class="docutils literal notranslate"><span class="pre">ParquetData.parquet_directory</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.ParquetData.parquet_path"><code class="docutils literal notranslate"><span class="pre">ParquetData.parquet_path</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pudl.helpers.persist_table_as_parquet"><code class="docutils literal notranslate"><span class="pre">persist_table_as_parquet()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.lf_from_parquet"><code class="docutils literal notranslate"><span class="pre">lf_from_parquet()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.df_from_parquet"><code class="docutils literal notranslate"><span class="pre">df_from_parquet()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.duckdb_relation_from_parquet"><code class="docutils literal notranslate"><span class="pre">duckdb_relation_from_parquet()</span></code></a></li>
<li><a class="reference internal" href="#pudl.helpers.duckdb_extract_zipped_csv"><code class="docutils literal notranslate"><span class="pre">duckdb_extract_zipped_csv()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../../_static/documentation_options.js?v=11fc87b4"></script>
    <script src="../../../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../../../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="../../../_static/scripts/furo.js?v=46bd48cc"></script>
    </body>
</html>