version: 2
sources:
  - name: pudl
    tables:
      - name: _core_eia923__yearly_byproduct_disposition
        data_tests:
          - expect_columns_not_all_null
          - check_row_counts_per_partition:
              table_name: _core_eia923__yearly_byproduct_disposition
              partition_column: report_year
          - expect_sum_close_to_total_column:
              name: total_disposal_units_discrepancy_rate
              sum_columns:
                - disposal_landfill_tons_or_mmbtu
                - disposal_offsite_tons_or_mmbtu
                - disposal_ponds_tons_or_mmbtu
                - sold_tons_or_mmbtu
                - stored_offsite_tons_or_mmbtu
                - stored_onsite_tons_or_mmbtu
                - used_offsite_tons_or_mmbtu
                - used_onsite_tons_or_mmbtu
              total_column: total_disposal_tons_or_mmbtu
              discrepancy_threshold: 0.01
              max_discrepancy_rate: 0.01
        columns:
          - name: report_year
          - name: plant_id_eia
          - name: byproduct_description
          - name: byproduct_units
          - name: disposal_landfill_tons_or_mmbtu
          - name: disposal_offsite_tons_or_mmbtu
          - name: disposal_ponds_tons_or_mmbtu
          - name: sold_tons_or_mmbtu
          - name: stored_offsite_tons_or_mmbtu
          - name: stored_onsite_tons_or_mmbtu
          - name: used_offsite_tons_or_mmbtu
          - name: used_onsite_tons_or_mmbtu
          - name: total_disposal_tons_or_mmbtu
          - name: no_byproducts_to_report
          - name: data_maturity
